!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){var n,i;n=[r,t,r(1),r(3)],void 0===(i=function(e,t,r,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){class t{}e.UnityController=class{constructor(e){this.video_player_id=e,this.legalMoves=[],this.video_player=null,this.currentData=null,this.tankCheerDiv=[],this.timeVisiblePrompt=100,this.timeVisibleMax=100,this.volumeChange=0,this.circleRadius=4,this.videoReady=!1,this.playerTableSetupCompletion=!1,this.lastGameData=null,this.lastMatchData=null,this.blueCheers=0,this.redCheers=0,this.blueCheerTime=0,this.redCheerTime=0,this.gfx_prog_data_viewproj=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.last_game_time_received=-1,this.isFullScreen=!1,this.on_video_ready_callback=null}onConnect(){$.post("/api/public/channels/join",{},e=>{this.on_channel_join(e)}).fail(e=>{alert("Can't get the stream info:"+e)})}onMute(){const e=document.querySelector("#mute-button i");this.promptOverlay=document.querySelector("#prompt_overlay"),this.client.videoPlayer.getMuted()?(e.classList.remove("fa-volume-off"),e.classList.add("fa-volume-up"),this.client.videoPlayer.setMuted(!1),this.promptOverlay.style.visibility="visible",this.promptOverlay.textContent="Volume is unmuted",this.timeVisiblePrompt=0):(e.classList.remove("fa-volume-up"),e.classList.add("fa-volume-off"),this.client.videoPlayer.setMuted(!0),this.promptOverlay.style.visibility="visible",this.promptOverlay.textContent="Volume is muted",this.timeVisiblePrompt=0)}on_channel_join(e){this.streamInfo=e.info,this.client=r.createGenvidClient(this.streamInfo,e.uri,e.token,this.video_player_id),this.client.onVideoPlayerReady(e=>{this.on_video_player_ready(e)}),this.client.onStreamsReceived(e=>{this.on_streams_received(e)}),this.client.onNotificationsReceived(this.on_notifications_received.bind(this)),this.client.onDraw(e=>{this.on_new_frame(e)}),this.client.start()}on_video_player_ready(e){this.voteActiveDiv=document.querySelector("#voting_active"),this.voteIdleDiv=document.querySelector("#voting_idle"),this.pieceSelect=document.querySelector("#pieces_select"),this.moveSelect=document.querySelector("#move_select"),this.pieceSelect.addEventListener("change",()=>{$("#move_select").empty(),this.legalMoves.forEach(e=>{e.StartSquare==this.pieceSelect.value&&(this.moveSelect[this.moveSelect.length]=new Option(e.MoveName,e.MoveName))})}),document.querySelector("#send_move_button").addEventListener("click",()=>{this.client.sendEventObject({vote:this.moveSelect.value}),this.voteActiveDiv.style.visibility="hidden",this.voteIdleDiv.style.visibility="visible"}),this.voteActiveDiv.style.visibility="hidden",this.video_player=this.client.videoPlayer,this.timeLocalDiv=document.querySelector("#time_local"),this.timeVideoDiv=document.querySelector("#time_video"),this.timeVideoRawDiv=document.querySelector("#time_video_raw"),this.timeComposeDiv=document.querySelector("#time_compose"),this.timeComposeLastDiv=document.querySelector("#time_compose_last"),this.timeStreamDiv=document.querySelector("#time_stream"),this.latencyDiv=document.querySelector("#latency"),this.delayOffsetDiv=document.querySelector("#delay_offset"),this.controlsDiv=document.querySelector("#game-controls"),this.timeCamSceneDiv=document.querySelector("#timeCamScene_overlay"),this.promptOverlay=document.querySelector("#prompt_overlay"),this.videoOverlay=document.querySelector("#video_overlay"),this.mapOverlay=document.querySelector("#map_overlay"),this.canvas3d=document.querySelector("#canvas_overlay_3d"),this.canvas2d=document.querySelector("#canvas_overlay_2d"),this.mouseOverlay=document.querySelector("#mouse_overlay"),this.genvidOverlayButton=document.querySelector("#genvid_overlay_button"),this.genvidOverlay=document.querySelector("#genvid_overlay"),this.help_overlay=document.querySelector("#help_overlay"),this.helpButton=document.querySelector("#help_button"),this.fullScreenDiv=document.querySelector(".fullscreen-button"),this.fullScreenElement=document.querySelector(".fa-expand"),this.genvidWebGL=r.createWebGLContext(this.canvas3d),this.context2d=this.canvas2d.getContext("2d"),this.mapImage=new Image,this.mapImage.src="img/map/mapBG.png",this.tankImage=new Image,this.tankImage.src="img/map/tank.png",this.shellImage=new Image,this.shellImage.src="img/map/shell.png",this.impactImage=new Image,this.impactImage.src="img/map/impact.png",this.lootImage=new Image,this.lootImage.src="img/map/loot.png",this.hideOverlay(),this.client.videoPlayer.addEventListener(r.PlayerEvents.PAUSE,()=>{this.hideOverlay()}),this.client.videoPlayer.addEventListener(r.PlayerEvents.PLAYING,()=>{this.showOverlay()}),this.on_video_ready_callback&&this.on_video_ready_callback(),this.mouseOverlay.addEventListener("click",e=>{this.setSelection(0)},!1),document.addEventListener("fullscreenchange",()=>{this.onResize()}),document.addEventListener("webkitfullscreenchange",()=>{this.onResize()}),document.addEventListener("mozfullscreenchange",()=>{this.onResize()}),e.addEventListener("resize",()=>{this.onResize()}),window.addEventListener("resize",()=>{this.onResize()},!0),window.addEventListener("orientationchange",()=>{this.onResize()},!0),window.addEventListener("sizemodechange",()=>{this.onResize()},!0),window.setInterval(()=>{this.onResize()},1e3),this.genvidOverlayButton.addEventListener("click",e=>{this.toggleGenvidOverlay()},!1),this.helpButton.addEventListener("click",e=>{this.onHelpActivation()},!1),this.fullScreenDiv.addEventListener("click",e=>{this.toggleFullScreen()},!1);document.getElementById("mute-button").addEventListener("click",()=>this.onMute()),this.video_player.getMuted()||this.onMute(),this.genvidWebGL.clear();let t=this.genvidWebGL.gl;t.disable(t.DEPTH_TEST),this.gfx_initShaders(),this.gfx_initRenderCommands(),window.requestAnimationFrame(this.mapUpdate),this.onResize(),this.videoReady=!0}showOverlay(){this.genvidOverlay.style.display="block"}hideOverlay(){this.genvidOverlay.style.display="none"}on_video_ready(e){this.on_video_ready_callback=e}on_new_frame(e){if(e.annotations.voteStart&&0!=e.annotations.voteStart.length){const t=JSON.parse(r.UTF8ToString(e.annotations.voteStart[0].rawdata));this.legalMoves=t.LegalMoves,$("#pieces_select").empty();let n=[];this.legalMoves.forEach(e=>{-1==n.indexOf(e.StartSquare)&&(n[n.length]=e.StartSquare,this.pieceSelect.options[this.pieceSelect.options.length]=new Option(`${e.StartSquare} (${e.Piece})`,e.StartSquare))}),this.voteActiveDiv.style.visibility="visible",this.voteIdleDiv.style.visibility="hidden"}let t=e.streams.GameData,n=null;if(t&&t.user){n=t.user;let r=n.tanks;this.tankData=r,this.explosionMatrices=n.explosionMatrices,this.lootMatrices=n.lootMatrices,this.shellMatrices=n.shellMatrices;let i=e.annotations.MatchState;if(i)for(let e of i){let t=e.user;this.refreshMatchState(t,r)}!1===this.playerTableSetupCompletion&&(this.playerTableSetupCompletion=!0,this.initPlayerTable(r));let o=n.matProjView;this.gfx_prog_data_viewproj=[o.e00,o.e10,o.e20,o.e30,o.e01,o.e11,o.e21,o.e31,o.e02,o.e12,o.e22,o.e32,o.e03,o.e13,o.e23,o.e33],this.lootDropUpdate(n.lootCountdown),this.tankOverlayUpdate(r,n.matProjView),this.adOverlayUpdate(n.adBillboardMatrix),this.gfx_draw3D()}this.videoReady&&(this.genvidInformationOverlayUpdate(),this.visibilityUpdate());let i=this.checkFullScreen();i!==this.isFullScreen&&(this.isFullScreen=i)}StringForTank(e,t){return"<span style='color:"+("rgb("+255*e.color.r+","+255*e.color.g+","+255*e.color.b+")")+"'>"+e.name+"</span>"+t}refreshMatchState(e,t){let r=document.querySelector("#roundInfo"),n=document.querySelector("#topText"),i=document.querySelector("#score1"),o=document.querySelector("#score2");if(0==e.stateID)r.style.display="block",n.textContent="Round "+e.roundNumber,i.style.display="none",o.style.display="none";else if(1==e.stateID)r.style.display="none";else if(2==e.stateID){r.style.display="block",this.setSelection(0);var s,a=null;if(0!=e.winningTankId&&(a=t[e.winningTankId-1]),null!=a&&5==a.roundWins)n.innerHTML=this.StringForTank(a," Wins the Match!"),i.style.display="none",o.style.display="none";else s=null==a?"Draw":this.StringForTank(a," Wins the Round!"),n.innerHTML=s,i.innerHTML=this.StringForTank(t[0],": "+t[0].roundWins+(1==t[0].roundWins?" Win":" Wins")),o.innerHTML=this.StringForTank(t[1],": "+t[1].roundWins+(1==t[1].roundWins?" Win":" Wins")),i.style.display="block",o.style.display="block"}}lootDropUpdate(e){if(e>0){let r=document.querySelector("#lootDropTimer");var t=Math.round(e);r.textContent="Incoming loot drop! "+t,r.style.visibility="visible",r.style.display="block"}else{let e=document.querySelector("#lootDropTimer");e.style.visibility="hidden",e.style.display="none"}if(1e3*e>this.client.streamLatencyMS){let r=document.querySelector("#lootDropTimer");t=Math.round(e-this.client.streamLatencyMS/1e3);if(r.textContent="Vote for the next loot drop! "+t,this.latestLootVoteData){document.querySelector("#voteResultMine").textContent="Mine Votes: "+this.latestLootVoteData.lootVotes[0],document.querySelector("#voteResultHealth").textContent="Health Votes: "+this.latestLootVoteData.lootVotes[1],document.querySelector("#voteResultAttack").textContent="Attack Votes: "+this.latestLootVoteData.lootVotes[2],document.querySelector("#voteResultMovement").textContent="Mobility Votes: "+this.latestLootVoteData.lootVotes[3],document.querySelector("#voteResultShield").textContent="Shield Votes: "+this.latestLootVoteData.lootVotes[4]}let n=document.querySelector("#voteInfoPanel");n.style.visibility="visible",n.style.display="block"}else{let e=document.querySelector("#voteInfoPanel");e.style.visibility="hidden",e.style.display="none"}}tankOverlayUpdate(e,t){if(e){let r=[];for(let i of e){let e=i.matrix,o=n.vec3(e.e03,e.e13,e.e23);if(this.isSelected(0)){this.gfx_cmd_selection.mat=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}else if(this.isSelected(i.id)){let t=this.circleRadius,i=n.vec4(1,0,0,1);this.makeCircleY(r,0,0,0,t,i);let o=r.length/36,s=this.genvidWebGL,a=this.gfx_cmd_selection;a.vtx=s.createBuffer(new Float32Array(r)),a.idx=s.createIndexBufferForQuads(o),a.mat=[1,0,0,0,0,1,0,0,0,0,1,0,e.e03,e.e13,e.e23,1]}let s=this.findOrCreateTagDiv(i),a=this.convertMatrix(t),c=n.projectPosition(a,o);this.center_at(s,c,n.vec2(0,-50));let u=this.findOrCreateCheerDiv(i);this.center_at(u,c,n.vec2(0,-50));let l=this.findOrCreateDetailsDiv(i);this.center_at(l,c,n.vec2(0,150))}}}adOverlayUpdate(e){let t=[];this.SetupVertexBuffer(t,1.1);let r=t.length/36,n=this.genvidWebGL,i=this.gfx_cmd_ad;i.vtx=n.createBuffer(new Float32Array(t)),i.idx=n.createIndexBufferForQuads(r),i.mat=[e.e00,e.e10,e.e20,e.e30,e.e01,e.e11,e.e21,e.e31,e.e02,e.e12,e.e22,e.e32,e.e03,e.e13,e.e23,e.e33]}genvidInformationOverlayUpdate(){let e=18,t=new Date;this.timeLocalDiv.textContent="Local: "+this.msToDuration(Math.round(t.getTime()));let r=0,n=this.client.videoPlayer;n&&(r=1e3*n.getCurrentTime()),this.timeVideoRawDiv.textContent="Raw Video: "+this.preN(this.msToDuration(Math.round(r)),e),this.timeVideoDiv.textContent="Est. Video: "+this.preN(this.msToDuration(Math.round(this.client.videoTimeMS)),e),this.timeComposeLastDiv.textContent="Last Compose: "+this.preN(this.msToDuration(Math.round(this.client.lastComposeTimeMS)),e),this.timeComposeDiv.textContent="Est. Compose: "+this.preN(this.msToDuration(Math.round(this.client.composeTimeMS)),e),this.timeStreamDiv.textContent="Stream: "+this.preN(this.msToDuration(Math.round(this.client.streamTimeMS)),e),this.latencyDiv.textContent=`Latency: ${this.preN(this.client.streamLatencyMS.toFixed(0),15)} ms`,this.delayOffsetDiv.textContent=`DelayOffset: ${this.preN(this.client.delayOffset.toFixed(0),15)} ms`}visibilityUpdate(){"visible"===this.promptOverlay.style.visibility&&this.timeVisiblePrompt<this.timeVisibleMax?(this.timeVisiblePrompt++,(2===this.volumeChange||1===this.volumeChange)&&(this.volumeChange=0,this.promptOverlay.textContent="Volume: "+this.client.videoPlayer.getVolume().toString()+" %")):"visible"===this.promptOverlay.style.visibility&&this.timeVisiblePrompt>=this.timeVisibleMax&&(this.promptOverlay.style.visibility="hidden")}initPlayerTable(e){for(let r of e){let e="<div class='clickable tank"+r.id+"'>\n                                    <div>\n                                        <span class='tank_name clickable'>"+r.name+"</span>\n                                        <button class='cheer' id='tank"+r.id+"_cheerbutton'><i class='icon_like' aria-hidden='true'></i></button>\n                                        <span class='cheer_value tank"+r.id+"_cheer'></span>\n                                    </div>\n                                </div>";var t="";t=1==r.id?"#leftTankPanel":"#rightTankPanel",$(t).append(e),document.querySelector("#tank"+r.id+"_cheerbutton").addEventListener("click",e=>{this.onCheer(r.id),e.stopPropagation()},!1);let n=document.querySelector(".tank"+r.id);n.addEventListener("click",e=>{this.setSelection(r.id),e.stopPropagation()},!1),this.tankCheerDiv.push(n)}}on_streams_received(e){for(let t of e.streams)for(let e of t.frames)this.last_game_time_received<e.timeCode&&(this.last_game_time_received=e.timeCode);for(let t of[...e.streams,...e.annotations])for(let e of t.frames)try{"GameData"==t.id&&(e.user=JSON.parse(e.data)),"MatchState"==t.id&&(e.user=JSON.parse(e.data))}catch(t){console.info("invalid Json format for:"+e.data+" with error :"+t)}}on_notifications_received(e){for(let t of e.notifications)if("LootVotesData"===t.id){let e=r.UTF8ToString(t.rawdata);try{let t=JSON.parse(e);this.latestLootVoteData=t}catch(t){console.info("invalid Json format for:"+e+" with error :"+t)}}}onKeyDown(e){let t=e.code||this.getKeyCode(e);"Equal"===t||"NumpadAdd"===t?this.changeOffset(1,e):"Minus"===t||"NumpadSubtract"===t?this.changeOffset(-1,e):"NumpadMultiply"===t?this.changeOffset(0,e):"KeyG"===t?this.toggleGenvidOverlay():"Space"===t?(this.client.videoPlayer.isPaused()?this.client.videoPlayer.play():this.client.videoPlayer.pause(),e.preventDefault()):"KeyM"===t?this.onMute():"KeyZ"===t?(this.promptOverlay=document.querySelector("#prompt_overlay"),this.client.videoPlayer.setVolume(this.client.videoPlayer.getVolume()-20),this.promptOverlay.style.visibility="visible",this.timeVisiblePrompt=0,this.volumeChange=2):"KeyX"===t?(this.promptOverlay=document.querySelector("#prompt_overlay"),this.client.videoPlayer.setVolume(this.client.videoPlayer.getVolume()+20),this.promptOverlay.style.visibility="visible",this.timeVisiblePrompt=0,this.volumeChange=1):"KeyH"===t&&this.onHelpActivation()}getKeyCode(e){if(e.keyCode){if(console.log(e.keyCode,e.code),65<=e.keyCode&&e.keyCode<=90)return"Key"+String.fromCharCode(e.keyCode);switch(e.keyCode){case 13:return"Enter";case 106:return"NumpadMultiply";case 107:return"NumpadAdd";case 109:return"NumpadSubtract";case 110:return"NumpadDecimal";case 111:return"NumpadDivide";case 187:return"Equal";case 188:return"Comma";case 189:return"Minus";case 190:return"Period";case 222:return"Backquote"}}}onResize(){let e,t,r=this.client.videoElem,i=r?n.vec2(r.clientWidth,r.clientHeight):n.vec2(1280,720),o=i.x/i.y,s=this.client.videoAspectRatio;if(s>=o){let r=i.x/s,o=.5*(i.y-r);e=n.vec2(0,Math.round(o)),t=n.vec2(i.x,Math.round(r))}else{let r=i.y*s,o=.5*(i.x-r);e=n.vec2(Math.round(o),0),t=n.vec2(Math.round(r),i.y)}let a=this.videoOverlay.style,c=n.vec2(parseInt(a.left),parseInt(a.top)),u=n.vec2(parseInt(a.width),parseInt(a.height));n.equal2D(u,t,.9)&&n.equal2D(c,e,.9)||(this.videoOverlay.style.left=e.x+"px",this.videoOverlay.style.width=t.x+"px",this.videoOverlay.style.top=e.y+"px",this.videoOverlay.style.height=t.y+"px",this.canvas3d.width=t.x,this.canvas3d.height=t.y,this.genvidWebGL.setViewport(0,0,t.x,t.y));let l=.5*t.y;this.mapOverlay.style.width=l+"px",this.mapOverlay.style.height=l+"px",this.canvas2d.width=l,this.canvas2d.height=l,null!=this.lastSelection&&this.setSelection(this.lastSelection)}toggleFullScreen(){let e=document;if(this.checkFullScreen())e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen(),this.fullScreenElement.classList.remove("fa-compress"),this.fullScreenElement.classList.add("fa-expand");else{let e=document.querySelector("#video_area");e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.fullScreenElement.classList.remove("fa-expand"),this.fullScreenElement.classList.add("fa-compress")}}setSelection(e){if(this.lastSelection>0){let e="tank_details_"+this.lastSelection,t=document.querySelector("#"+e);null!=t&&(t.style.visibility="hidden")}this.lastSelection=e;let t="tank_details_"+e,r=document.querySelector("#"+t);null!=r&&(r.style.visibility="visible")}isSelected(e){return this.lastSelection==e}changeOffset(e,t){if(0!==e){let r=100*e;t.altKey&&(r*=10),t.shiftKey&&(r/=2);let n=this.client.delayOffset+r;this.client.delayOffset=n}else this.client.delayOffset=0}toggleGenvidOverlay(){this.genvidOverlay.getAttribute("data-isHidden")?(this.genvidOverlay.setAttribute("data-isHidden",""),this.genvidOverlay.style.visibility="visible",this.genvidOverlayButton.classList.remove("disabled")):(this.genvidOverlay.setAttribute("data-isHidden","true"),this.genvidOverlay.style.visibility="hidden",this.genvidOverlayButton.classList.add("disabled"))}onHelpActivation(){"visible"===this.help_overlay.style.visibility?this.help_overlay.style.visibility="hidden":this.help_overlay.style.visibility="visible"}onCheer(e){let t=new Date,r=Math.round(t.getTime());1==e?(r>this.blueCheerTime+2e3&&(this.blueCheers=0),this.blueCheerTime=r+2e3,this.blueCheers++):2==e&&(r>this.redCheerTime+2e3&&(this.redCheers=0),this.redCheerTime=r+2e3,this.redCheers++),this.client.sendEventObject({cheer:e})}gfx_draw3D(){let e=this.genvidWebGL,t=e.gl;e.clear();let r=this.gfx_prog;t.useProgram(r),t.enableVertexAttribArray(0),t.enableVertexAttribArray(1),t.enableVertexAttribArray(2),t.activeTexture(t.TEXTURE0),t.uniform1i(t.getUniformLocation(r,"tex"),0),this.gfx_prog_data_viewproj&&t.uniformMatrix4fv(this.gfx_prog_loc_viewproj,!1,this.gfx_prog_data_viewproj);let n=[this.gfx_cmd_selection,this.gfx_cmd_ad];for(let r of n)r.visible&&r.vtx&&(t.bindBuffer(t.ARRAY_BUFFER,r.vtx[0]),t.vertexAttribPointer(0,3,t.FLOAT,!1,36,0),t.vertexAttribPointer(1,2,t.FLOAT,!1,36,12),t.vertexAttribPointer(2,4,t.FLOAT,!1,36,20),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.idx[0]),t.bindTexture(t.TEXTURE_2D,r.tex),null!=r.mat&&t.uniformMatrix4fv(this.gfx_prog_loc_world,!1,r.mat),e.checkGLError(),t.drawElements(t.TRIANGLES,r.idx[1],t.UNSIGNED_SHORT,0),e.checkGLError())}gfx_initShaders(){let e=this.genvidWebGL,t=["uniform mat4 g_ViewProjMat;","uniform mat4 g_mWorldMat;","attribute vec3 g_Position;","attribute vec2 g_TexCoord0;","attribute vec4 g_Color0;","varying vec2 texCoord;","varying vec4 color;","void main()","{","   gl_Position = g_ViewProjMat * g_mWorldMat * vec4(g_Position, 1.0);","   texCoord = g_TexCoord0;","   color = g_Color0;","}"].join("\n"),r=["precision mediump float;","uniform sampler2D tex;","varying vec2 texCoord;","varying vec4 color;","void main()","{","   vec4 texColor = texture2D(tex, texCoord);","   gl_FragColor = texColor * color;","}"].join("\n"),n=e.loadVertexShader(t),i=e.loadFragmentShader(r);this.gfx_prog=e.loadProgram(n,i,["g_Position","g_TexCoord0"]),this.gfx_prog_loc_viewproj=e.gl.getUniformLocation(this.gfx_prog,"g_ViewProjMat"),this.gfx_prog_loc_world=e.gl.getUniformLocation(this.gfx_prog,"g_mWorldMat")}gfx_initRenderCommands(){let e=this.genvidWebGL.gl;function r(t,r,n){if(n=n||{},e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),n.wrap&&(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrap),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrap)),n.aniso){let t=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");if(t){let r=e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);e.texParameterf(e.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,r)}}e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)}let n=this.gfx_draw3D.bind(this);{let i=new t,o={wrap:e.CLAMP_TO_EDGE,aniso:!0};i.tex=e.createTexture(),i.img=new Image,i.img.onload=function(){r(i.img,i.tex,o),n&&n()},i.img.src="img/highlight.png",i.visible=!0,this.gfx_cmd_selection=i}{let i=new t,o={wrap:e.CLAMP_TO_EDGE,aniso:!0};i.tex=e.createTexture(),i.img=new Image,i.img.onload=function(){r(i.img,i.tex,o),n&&n()},i.img.src="img/billboardImage.png",i.visible=!0,this.gfx_cmd_ad=i}this.gfx_draw3D()}SetupVertexBuffer(e,t){e.push(0,0+t,0+t,0,0,1,1,1,1,0,0+t,0-t,1,0,1,1,1,1,0,0-t,0-t,1,1,1,1,1,1,0,0-t,0+t,0,1,1,1,1,1)}makeCircleY(e,t,r,n,i,o){e.push(t-i,r,n-i,0,0,o.x,o.y,o.z,o.w,t+i,r,n-i,1,0,o.x,o.y,o.z,o.w,t+i,r,n+i,1,1,o.x,o.y,o.z,o.w,t-i,r,n+i,0,1,o.x,o.y,o.z,o.w)}projectWithRadius(e,t,r){let i=n.projectPosition(e,t),o=0,s=[n.vec3(r,0,0),n.vec3(-r,0,0),n.vec3(0,r,0),n.vec3(0,-r,0),n.vec3(0,0,r),n.vec3(0,0,-r)];for(let r=0;r<s.length;++r){let a=s[r],c=n.add3D(t,a),u=n.projectPosition(e,c),l=n.lengthSq2D(n.sub2D(i,u));o=Math.max(o,l)}return[i,Math.sqrt(o)]}center_at(e,t,r){let i=n.vec2(.5,.5),o=n.mad2D(t,i,i),s=e.parentElement,a=n.vec2(s.clientWidth,s.clientHeight),c=n.mul2D(o,a),u=n.vec2(e.clientWidth,e.clientHeight),l=n.muls2D(u,-.5),d=n.add2D(c,l),p=n.sub2D(d,r);$(e).css({left:p.x,bottom:p.y,position:"absolute"})}preN(e,t){let r=e.length;return r<t&&(e=" ".repeat(t-r)+e),e}convertMatrix(e){return n.mat4(n.vec4(e.e00,e.e01,e.e02,e.e03),n.vec4(e.e10,e.e11,e.e12,e.e13),n.vec4(e.e20,e.e21,e.e22,e.e23),n.vec4(e.e30,e.e31,e.e32,e.e33))}findOrCreateTagDiv(e){let t="tank_tag_"+e.id,r=document.querySelector("#"+t);if(null==r){r=document.createElement("div"),r.id=t,r.textContent=e.name,r.classList.add("tag"),document.querySelector("#mouse_overlay").appendChild(r),r.addEventListener("click",t=>{this.setSelection(e.id),t.stopPropagation()},!1)}return r}findOrCreateCheerDiv(e){let t="tank_cheer_"+e.id,r=document.querySelector("#"+t);if(null==r){r=document.createElement("div"),r.id=t,r.classList.add("cheers"),document.querySelector("#mouse_overlay").appendChild(r)}let n=new Date,i=Math.round(n.getTime());if(1==e.id){r.textContent="+"+this.blueCheers.toString()+" cheers";let e=(this.blueCheerTime-i)/2e3;r.style.opacity=e.toString()}else if(2==e.id){r.textContent="+"+this.redCheers.toString()+" cheers";let e=(this.redCheerTime-i)/2e3;r.style.opacity=e.toString()}return r}findOrCreateDetailsDiv(e){let t="tank_details_"+e.id,r=document.querySelector("#"+t);var n=Math.round(e.shotsHit/e.shotsFired*100);if(isNaN(n)&&(n=0),null==r){r=document.createElement("div"),r.id=t;let e="<div id="+t+"_inner></div>";r.innerHTML=e,r.classList.add("details"),document.querySelector("#mouse_overlay").appendChild(r)}let i="tank_details_"+e.id+"_inner",o=document.querySelector("#"+i);var s;s=2==e.activeBuff?"Attack":3==e.activeBuff?"Movement":4==e.activeBuff?"Shield":"none";let a="Health: "+e.health.toFixed(0)+"%</br>Shots fired: "+e.shotsFired+"</br>Shots hit: "+e.shotsHit+"</br>Accuracy: "+n+"%</br>Active Buff: "+s+"</br>Cheers: "+e.cheers;return o.innerHTML=a,r}msToDuration(e){let t="";e<0&&(t+="-",e=-e);let r=864e5,n=!1;if(e>r){n=!0;let i=e%r,o=(e-i)/r;e=i,t+=o+":"}if(n||e>36e5){n=!0;let r=e%36e5,i=(e-r)/36e5;e=r,i<10&&(t+="0"),t+=i+":"}if(n||e>6e4){n=!0;let r=e%6e4,i=(e-r)/6e4;e=r,i<10&&(t+="0"),t+=i+":"}if(n||e>1e3){let r=e%1e3,n=(e-r)/1e3;e=r,n<10&&(t+="0"),t+=n+"."}else t+="0.";return e<100&&(t+="0"),e<10&&(t+="0"),t+""+e}checkFullScreen(){let e=document;return e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement}mapUpdate(){if(null!=o.context2d&&o.tankImage.complete&&o.mapImage.complete&&o.shellImage.complete&&o.impactImage.complete&&o.tankData){o.context2d.drawImage(o.mapImage,0,0,o.canvas2d.width,o.canvas2d.height);let e=o.tankData;for(let t of e){if(t.health<=0)continue;let e=32,r=-e/2,i=t.matrix,s=n.vec3(i.e03,i.e13,i.e23),a=Math.atan2(i.e02,i.e00),c=45,u=Math.round((s.x+c)/(2*c)*o.canvas2d.width)+r,l=Math.round((s.z+c)/(2*c)*o.canvas2d.height)+r;o.context2d.save(),o.context2d.translate(u,l),o.context2d.scale(1,-1),o.context2d.rotate(a),o.context2d.drawImage(o.tankImage,r,r,e,e);let d="rgb("+255*t.color.r+","+255*t.color.g+","+255*t.color.b+")";o.context2d.globalCompositeOperation="source-atop",o.context2d.globalAlpha=.5,o.context2d.fillStyle=d,o.context2d.fillRect(r,r,e,e),o.context2d.restore()}let t=o.shellMatrices;for(let e of t){let t=24,r=-t/2,i=e,s=n.vec3(i.e03,i.e13,i.e23),a=Math.atan2(i.e02,i.e00),c=45,u=Math.round((s.x+c)/(2*c)*o.canvas2d.width)+r,l=Math.round((s.z+c)/(2*c)*o.canvas2d.height)+r;o.context2d.save(),o.context2d.translate(u,l),o.context2d.scale(1,-1),o.context2d.rotate(a),o.context2d.drawImage(o.shellImage,r,r,t,t),o.context2d.restore()}let r=o.lootMatrices;for(let e of r){let t=32,r=-t/2,i=e,s=n.vec3(i.e03,i.e13,i.e23),a=Math.atan2(i.e02,i.e00),c=45,u=Math.round((s.x+c)/(2*c)*o.canvas2d.width)+r,l=Math.round((s.z+c)/(2*c)*o.canvas2d.height)+r;o.context2d.save(),o.context2d.translate(u,l),o.context2d.scale(1,-1),o.context2d.rotate(a),o.context2d.drawImage(o.lootImage,r,r,t,t),o.context2d.restore()}let i=o.explosionMatrices;for(let e of i){let t=32,r=-t/2,i=e,s=n.vec3(i.e03,i.e13,i.e23),a=Math.atan2(i.e02,i.e00),c=45,u=Math.round((s.x+c)/(2*c)*o.canvas2d.width)+r,l=Math.round((s.z+c)/(2*c)*o.canvas2d.height)+r;o.context2d.save(),o.context2d.translate(u,l),o.context2d.scale(1,-1),o.context2d.rotate(a),o.context2d.drawImage(o.impactImage,r,r,t,t),o.context2d.restore()}}window.requestAnimationFrame(o.mapUpdate)}}}(i||(i={}));let o=new i.UnityController("video_player");o.onConnect(),window.addEventListener("keydown",e=>{o.onKeyDown(e)},!0)}.apply(t,n))||(e.exports=i)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(global){__webpack_require__.d(__webpack_exports__,"decode",(function(){return decode})),__webpack_require__.d(__webpack_exports__,"UTF8ToString",(function(){return UTF8ToString})),__webpack_require__.d(__webpack_exports__,"UTF16ToString",(function(){return UTF16ToString})),__webpack_require__.d(__webpack_exports__,"createGenvidClient",(function(){return createGenvidClient})),__webpack_require__.d(__webpack_exports__,"createWebGLContext",(function(){return createWebGLContext})),__webpack_require__.d(__webpack_exports__,"PlayerEvents",(function(){return PlayerEvents})),__webpack_require__.d(__webpack_exports__,"log",(function(){return log})),__webpack_require__.d(__webpack_exports__,"warn",(function(){return warn})),__webpack_require__.d(__webpack_exports__,"error",(function(){return error})),__webpack_require__.d(__webpack_exports__,"info",(function(){return info})),__webpack_require__.d(__webpack_exports__,"trace",(function(){return trace})),__webpack_require__.d(__webpack_exports__,"assert",(function(){return assert})),__webpack_require__.d(__webpack_exports__,"clear",(function(){return clear})),__webpack_require__.d(__webpack_exports__,"count",(function(){return count})),__webpack_require__.d(__webpack_exports__,"time",(function(){return time})),__webpack_require__.d(__webpack_exports__,"timeEnd",(function(){return timeEnd})),__webpack_require__.d(__webpack_exports__,"setConfig",(function(){return setConfig})),__webpack_require__.d(__webpack_exports__,"getConfig",(function(){return getConfig}));var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function __awaiter(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function __generator(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof __await?Promise.resolve(r.value.v).then(c,u):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}var ERROR_NOT_A_BROWSER='The genvid "window" or "WebSocket" polyfills have not been set properly,\nit\'s probably because you are trying to run this lib with nodejs. Please consider\nusing setConfig() to provide WebSocket and window replacements before creating the\nplayer. We advise you to use the npm packages "ws" and "jsdom".',GenvidConfig=function(){function e(e){this.framePerSeconds=e.framePerSeconds,this.console=e.console,this.gameDataMaxAge=e.gameDataMaxAge,this.websocketConnectionTimeout=e.websocketConnectionTimeout,this._websocket=e.newWebsocket,this._window=e.window}return Object.defineProperty(e.prototype,"newWebsocket",{get:function(){if(!this._websocket)throw Error(ERROR_NOT_A_BROWSER);return this._websocket},set:function(e){this._websocket=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){if(!this._window)throw Error(ERROR_NOT_A_BROWSER);return this._window},set:function(e){this._window=e},enumerable:!0,configurable:!0}),e.prototype.setConfig=function(e){var t,r;try{for(var n=__values(["framePerSeconds","console","websocketConnectionTimeout","newWebsocket","window"]),i=n.next();!i.done;i=n.next()){var o=i.value;o in e&&(this[o]=e[o])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e}(),newWebsocket=void 0;"undefined"!=typeof WebSocket&&(newWebsocket=function(e,t){return new WebSocket(e,t)});var config=new GenvidConfig({framePerSeconds:30,console:console,websocketConnectionTimeout:30,gameDataMaxAge:8,newWebsocket:newWebsocket,window:"undefined"==typeof window?void 0:window});function setConfig(e){config.setConfig(e)}function getConfig(){return config}function _callConsoleMethod(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=getConfig().console;if(n){var i=n[e];i&&i.apply(void 0,__spread(t))}}function log(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["log",e],t))}function warn(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["warn",e],t))}function error(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["error",e],t))}function info(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["info",e],t))}function trace(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["trace",e],t))}function assert(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];e||_callConsoleMethod.apply(void 0,__spread(["assert",e,t],r))}function clear(){_callConsoleMethod("clear")}function count(e){_callConsoleMethod("count",e)}function time(e){_callConsoleMethod("time",e)}function timeEnd(e){_callConsoleMethod("timeEnd",e)}var tokens="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function getInvTokens(){for(var e=[],t=tokens.length,r=0;r<t;++r)e[tokens.charCodeAt(r)]=r;return e}var invTokens=getInvTokens();function getNumPaddingEquals(e){for(var t=e.length-1,r=0;t-r>=0&&"="===e[t-r];)++r;return r}function decode(e){var t=e.length,r=getNumPaddingEquals(e),n=new ArrayBuffer(3*t/4-r),i=new Uint8Array(n),o=t;r>0&&(o-=4);var s,a,c=0;for(a=0;a<o;a+=4)s=invTokens[e.charCodeAt(a)],s<<=6,s|=invTokens[e.charCodeAt(a+1)],s<<=6,s|=invTokens[e.charCodeAt(a+2)],s<<=6,s|=invTokens[e.charCodeAt(a+3)],i[c++]=s>>16&255,i[c++]=s>>8&255,i[c++]=255&s;return r>0&&(s=invTokens[e.charCodeAt(a)],s<<=6,s|=invTokens[e.charCodeAt(a+1)],s<<=6,s|=invTokens[e.charCodeAt(a+2)],s<<=6,s|=invTokens[e.charCodeAt(a+3)],1===r?(i[c++]=s>>16&255,i[c++]=s>>8&255):i[c++]=s>>16&255),n}function UTF8ToString(e){var t,r,n,i,o,s,a="",c=String.fromCodePoint||String.fromCharCode,u=(s=e instanceof ArrayBuffer?new Uint8Array(e):e).length;for(t=0;t<u;++t)if((r=s[t])<128)a+=c(r);else if(r<194)warn("Invalid UTF-8: Unexpected continuation sequence at byte "+t+": "+r+"."),a+="�";else if(r>244)warn("Invalid UTF-8: Non-normalized character at byte "+t+": "+r+".");else{if(r<224?(i=1,n=31&r):r<240?(i=2,n=15&r):(i=3,n=7&r),t+i>=u){warn("Invalid UTF-8: Last continuation at byte "+t+" extends past end-of-data."),a+="�";break}o=!0;for(var l=0;l<i;++l){if((r=s[t+l+1])<128||r>193){warn("Invalid UTF-8: Non-continuation at byte "+(t+l)+": "+r+"."),a+="�",o=!1,i=l;break}n*=64,n+=63&r}o&&(a+=c(n),t+=i)}return a}function UTF16ToString(e){var t,r,n,i,o,s="",a=String.fromCodePoint||String.fromCharCode,c=(o=e instanceof ArrayBuffer?new Uint16Array(e):e).length;for(t=0,c>=1&&65279===o[t]&&++t;t<c;++t)if(55296==(n=64512&(r=o[t]))){if(i=r-n,!(++t<c)){warn("Invalid UTF-16: out-of-bound access."),s+="�";break}56320==(n=64512&(r=o[t]))?(i*=1024,i+=r-n,warn("["+t+"]: "+(i+=65536)+" "+a(i)),s+=a(i)):(warn("Invalid UTF-16: expecting low surrogate."),s+="�")}else 56320===n?(warn("Invalid UTF-16: unexpected low surrogate."),s+="�"):s+=a(r);return s}var commonjsGlobal="undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var aspromise=asPromise;function asPromise(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}}))}var base64_1=createCommonjsModule((function(e,t){var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),i=new Array(123),o=0;o<64;)i[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,r){for(var i,o=null,s=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:s[a++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:s[a++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:s[a++]=n[i|u>>6],s[a++]=n[63&u],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=n[i],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))},r.decode=function(e,t,r){for(var n,o=r,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(s){case 0:n=c,s=1;break;case 1:t[r++]=n<<2|(48&c)>>4,n=c,s=2;break;case 2:t[r++]=(15&n)<<4|(60&c)>>2,n=c,s=3;break;case 3:t[r++]=(3&n)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return r-o},r.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)}})),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this};var float_1=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=r.bind(null,readUintLE),e.readFloatBE=r.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,i,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function r(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+o;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=r.bind(null,readUintLE,0,4),e.readDoubleBE=r.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function writeUintBE(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8_1=createCommonjsModule((function(e,t){var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}})),pool_1=pool;function pool(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}var longbits=LongBits;function LongBits(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new LongBits(r,n)},LongBits.from=function(e){if("number"==typeof e)return LongBits.fromNumber(e);if(minimal.isString(e)){if(!minimal.Long)return LongBits.fromNumber(parseInt(e,10));e=minimal.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):zero},LongBits.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(e){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(e){return e===zeroHash?zero:new LongBits((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10};var minimal=createCommonjsModule((function(e,t){var r=t;function n(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=aspromise,r.base64=base64_1,r.EventEmitter=eventemitter,r.float=float_1,r.inquire=inquire_1,r.utf8=utf8_1,r.pool=pool_1,r.LongBits=longbits,r.global="undefined"!=typeof window&&window||void 0!==commonjsGlobal&&commonjsGlobal||"undefined"!=typeof self&&self||commonjsGlobal,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isNode=Boolean(r.global.process&&r.global.process.versions&&r.global.process.versions.node),r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=n,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},r.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}})),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}function writeByte(e,t,r){t[r]=255&e}function writeVarint32(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function writeFixed32(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Writer.create=minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer},Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Op(e,t,r),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};Writer.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(minimal.isString(e)){var r=Writer.alloc(t=base64.length(e));base64.decode(e,r,0),e=r}return this.uint32(t)._push(writeBytes,t,e)},Writer.prototype.string=function(e){var t=utf8.length(e);return t?this.uint32(t)._push(utf8.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},Writer.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},Writer._configure=function(e){BufferWriter=e};var writer_buffer=BufferWriter$1;(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1;var Buffer=minimal.Buffer;function BufferWriter$1(){writer.call(this)}BufferWriter$1.alloc=function(e){return(BufferWriter$1.alloc=minimal._Buffer_allocUnsafe)(e)};var writeBytesBuffer=Buffer&&Buffer.prototype instanceof Uint8Array&&"set"===Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]};function writeStringBuffer(e,t,r){e.length<40?minimal.utf8.write(e,t,r):t.utf8Write(e,r)}BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(writeBytesBuffer,t,e),this},BufferWriter$1.prototype.string=function(e){var t=Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this};var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},e;function readLongVarint(){var e=new LongBits$2(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=minimal.Buffer?function(e){return(Reader.create=function(e){return minimal.Buffer.isBuffer(e)?new BufferReader(e):create_array(e)})(e)}:create_array,Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(e=4294967295,function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e;var t=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice),BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))};var service=Service;function Service(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,r,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return minimal.asPromise(e,s,t,r,n,i);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,r){if(e)return s.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof n))try{r=n[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),o(e)}return s.emit("data",r,t),o(null,r)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule((function(e,t){t.Service=service})),roots={},indexMinimal=createCommonjsModule((function(e,t){var r=t;function n(){r.Reader._configure(r.BufferReader),r.util._configure()}r.build="minimal",r.Writer=writer,r.BufferWriter=writer_buffer,r.Reader=reader,r.BufferReader=reader_buffer,r.util=minimal,r.rpc=rpc_1,r.roots=roots,r.configure=n,r.Writer._configure(r.BufferWriter),n()})),minimal$1=indexMinimal,$Reader=minimal$1.Reader,$Writer=minimal$1.Writer,$util=minimal$1.util,$root=minimal$1.roots.default||(minimal$1.roots.default={});$root.genvid=function(){var e,t,r,n={};return n.proto=((r={}).DataFrames=function(){function e(e){if(this.annotations=[],this.streams=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.annotations=$util.emptyArray,e.prototype.streams=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.annotations&&e.annotations.length)for(var r=0;r<e.annotations.length;++r)$root.genvid.proto.Stream.encode(e.annotations[r],t.uint32(10).fork()).ldelim();if(null!=e.streams&&e.streams.length)for(r=0;r<e.streams.length;++r)$root.genvid.proto.Stream.encode(e.streams[r],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.DataFrames;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.annotations&&n.annotations.length||(n.annotations=[]),n.annotations.push($root.genvid.proto.Stream.decode(e,e.uint32()));break;case 2:n.streams&&n.streams.length||(n.streams=[]),n.streams.push($root.genvid.proto.Stream.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.annotations&&e.hasOwnProperty("annotations")){if(!Array.isArray(e.annotations))return"annotations: array expected";for(var t=0;t<e.annotations.length;++t)if(r=$root.genvid.proto.Stream.verify(e.annotations[t]))return"annotations."+r}if(null!=e.streams&&e.hasOwnProperty("streams")){if(!Array.isArray(e.streams))return"streams: array expected";for(t=0;t<e.streams.length;++t){var r;if(r=$root.genvid.proto.Stream.verify(e.streams[t]))return"streams."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.DataFrames)return e;var t=new $root.genvid.proto.DataFrames;if(e.annotations){if(!Array.isArray(e.annotations))throw TypeError(".genvid.proto.DataFrames.annotations: array expected");t.annotations=[];for(var r=0;r<e.annotations.length;++r){if("object"!=typeof e.annotations[r])throw TypeError(".genvid.proto.DataFrames.annotations: object expected");t.annotations[r]=$root.genvid.proto.Stream.fromObject(e.annotations[r])}}if(e.streams){if(!Array.isArray(e.streams))throw TypeError(".genvid.proto.DataFrames.streams: array expected");for(t.streams=[],r=0;r<e.streams.length;++r){if("object"!=typeof e.streams[r])throw TypeError(".genvid.proto.DataFrames.streams: object expected");t.streams[r]=$root.genvid.proto.Stream.fromObject(e.streams[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.annotations=[],r.streams=[]),e.annotations&&e.annotations.length){r.annotations=[];for(var n=0;n<e.annotations.length;++n)r.annotations[n]=$root.genvid.proto.Stream.toObject(e.annotations[n],t)}if(e.streams&&e.streams.length)for(r.streams=[],n=0;n<e.streams.length;++n)r.streams[n]=$root.genvid.proto.Stream.toObject(e.streams[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Stream=function(){function e(e){if(this.frames=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id="",e.prototype.fps=0,e.prototype.sessionId="",e.prototype.frames=$util.emptyArray,e.prototype.v2SessionId=0,e.prototype.v2SourceId=0,e.prototype.v2StreamId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.id&&e.hasOwnProperty("id")&&t.uint32(10).string(e.id),null!=e.fps&&e.hasOwnProperty("fps")&&t.uint32(17).double(e.fps),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&t.uint32(26).string(e.sessionId),null!=e.frames&&e.frames.length)for(var r=0;r<e.frames.length;++r)$root.genvid.proto.Frame.encode(e.frames[r],t.uint32(34).fork()).ldelim();return null!=e.v2SessionId&&e.hasOwnProperty("v2SessionId")&&t.uint32(40).uint32(e.v2SessionId),null!=e.v2SourceId&&e.hasOwnProperty("v2SourceId")&&t.uint32(48).uint32(e.v2SourceId),null!=e.v2StreamId&&e.hasOwnProperty("v2StreamId")&&t.uint32(56).uint32(e.v2StreamId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Stream;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.string();break;case 2:n.fps=e.double();break;case 3:n.sessionId=e.string();break;case 4:n.frames&&n.frames.length||(n.frames=[]),n.frames.push($root.genvid.proto.Frame.decode(e,e.uint32()));break;case 5:n.v2SessionId=e.uint32();break;case 6:n.v2SourceId=e.uint32();break;case 7:n.v2StreamId=e.uint32();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!$util.isString(e.id))return"id: string expected";if(null!=e.fps&&e.hasOwnProperty("fps")&&"number"!=typeof e.fps)return"fps: number expected";if(null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isString(e.sessionId))return"sessionId: string expected";if(null!=e.frames&&e.hasOwnProperty("frames")){if(!Array.isArray(e.frames))return"frames: array expected";for(var t=0;t<e.frames.length;++t){var r=$root.genvid.proto.Frame.verify(e.frames[t]);if(r)return"frames."+r}}return null!=e.v2SessionId&&e.hasOwnProperty("v2SessionId")&&!$util.isInteger(e.v2SessionId)?"v2SessionId: integer expected":null!=e.v2SourceId&&e.hasOwnProperty("v2SourceId")&&!$util.isInteger(e.v2SourceId)?"v2SourceId: integer expected":null!=e.v2StreamId&&e.hasOwnProperty("v2StreamId")&&!$util.isInteger(e.v2StreamId)?"v2StreamId: integer expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Stream)return e;var t=new $root.genvid.proto.Stream;if(null!=e.id&&(t.id=String(e.id)),null!=e.fps&&(t.fps=Number(e.fps)),null!=e.sessionId&&(t.sessionId=String(e.sessionId)),e.frames){if(!Array.isArray(e.frames))throw TypeError(".genvid.proto.Stream.frames: array expected");t.frames=[];for(var r=0;r<e.frames.length;++r){if("object"!=typeof e.frames[r])throw TypeError(".genvid.proto.Stream.frames: object expected");t.frames[r]=$root.genvid.proto.Frame.fromObject(e.frames[r])}}return null!=e.v2SessionId&&(t.v2SessionId=e.v2SessionId>>>0),null!=e.v2SourceId&&(t.v2SourceId=e.v2SourceId>>>0),null!=e.v2StreamId&&(t.v2StreamId=e.v2StreamId>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.frames=[]),t.defaults&&(r.id="",r.fps=0,r.sessionId="",r.v2SessionId=0,r.v2SourceId=0,r.v2StreamId=0),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.fps&&e.hasOwnProperty("fps")&&(r.fps=t.json&&!isFinite(e.fps)?String(e.fps):e.fps),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),e.frames&&e.frames.length){r.frames=[];for(var n=0;n<e.frames.length;++n)r.frames[n]=$root.genvid.proto.Frame.toObject(e.frames[n],t)}return null!=e.v2SessionId&&e.hasOwnProperty("v2SessionId")&&(r.v2SessionId=e.v2SessionId),null!=e.v2SourceId&&e.hasOwnProperty("v2SourceId")&&(r.v2SourceId=e.v2SourceId),null!=e.v2StreamId&&e.hasOwnProperty("v2StreamId")&&(r.v2StreamId=e.v2StreamId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.StreamFormat=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sessionId=0,e.prototype.sourceId=0,e.prototype.streamId=0,e.prototype.sessionName="",e.prototype.sourceName="",e.prototype.streamName="",e.prototype.fps=0,e.prototype.alive=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&t.uint32(8).uint32(e.sessionId),null!=e.sourceId&&e.hasOwnProperty("sourceId")&&t.uint32(16).uint32(e.sourceId),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(24).uint32(e.streamId),null!=e.sessionName&&e.hasOwnProperty("sessionName")&&t.uint32(34).string(e.sessionName),null!=e.sourceName&&e.hasOwnProperty("sourceName")&&t.uint32(42).string(e.sourceName),null!=e.streamName&&e.hasOwnProperty("streamName")&&t.uint32(50).string(e.streamName),null!=e.fps&&e.hasOwnProperty("fps")&&t.uint32(61).float(e.fps),null!=e.alive&&e.hasOwnProperty("alive")&&t.uint32(64).bool(e.alive),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.StreamFormat;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sessionId=e.uint32();break;case 2:n.sourceId=e.uint32();break;case 3:n.streamId=e.uint32();break;case 4:n.sessionName=e.string();break;case 5:n.sourceName=e.string();break;case 6:n.streamName=e.string();break;case 7:n.fps=e.float();break;case 8:n.alive=e.bool();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isInteger(e.sessionId)?"sessionId: integer expected":null!=e.sourceId&&e.hasOwnProperty("sourceId")&&!$util.isInteger(e.sourceId)?"sourceId: integer expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!$util.isInteger(e.streamId)?"streamId: integer expected":null!=e.sessionName&&e.hasOwnProperty("sessionName")&&!$util.isString(e.sessionName)?"sessionName: string expected":null!=e.sourceName&&e.hasOwnProperty("sourceName")&&!$util.isString(e.sourceName)?"sourceName: string expected":null!=e.streamName&&e.hasOwnProperty("streamName")&&!$util.isString(e.streamName)?"streamName: string expected":null!=e.fps&&e.hasOwnProperty("fps")&&"number"!=typeof e.fps?"fps: number expected":null!=e.alive&&e.hasOwnProperty("alive")&&"boolean"!=typeof e.alive?"alive: boolean expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.StreamFormat)return e;var t=new $root.genvid.proto.StreamFormat;return null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.sourceId&&(t.sourceId=e.sourceId>>>0),null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.sessionName&&(t.sessionName=String(e.sessionName)),null!=e.sourceName&&(t.sourceName=String(e.sourceName)),null!=e.streamName&&(t.streamName=String(e.streamName)),null!=e.fps&&(t.fps=Number(e.fps)),null!=e.alive&&(t.alive=Boolean(e.alive)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.sessionId=0,r.sourceId=0,r.streamId=0,r.sessionName="",r.sourceName="",r.streamName="",r.fps=0,r.alive=!1),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),null!=e.sourceId&&e.hasOwnProperty("sourceId")&&(r.sourceId=e.sourceId),null!=e.streamId&&e.hasOwnProperty("streamId")&&(r.streamId=e.streamId),null!=e.sessionName&&e.hasOwnProperty("sessionName")&&(r.sessionName=e.sessionName),null!=e.sourceName&&e.hasOwnProperty("sourceName")&&(r.sourceName=e.sourceName),null!=e.streamName&&e.hasOwnProperty("streamName")&&(r.streamName=e.streamName),null!=e.fps&&e.hasOwnProperty("fps")&&(r.fps=t.json&&!isFinite(e.fps)?String(e.fps):e.fps),null!=e.alive&&e.hasOwnProperty("alive")&&(r.alive=e.alive),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Frame=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timecode=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.composition=null,e.prototype.data=$util.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.timecode&&e.hasOwnProperty("timecode")&&t.uint32(8).int64(e.timecode),null!=e.pts&&e.hasOwnProperty("pts")&&t.uint32(16).int64(e.pts),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(24).int64(e.timestamp),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&t.uint32(32).int64(e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&t.uint32(40).int64(e.startIngestTime),null!=e.composition&&e.hasOwnProperty("composition")&&$root.genvid.proto.Composition.encode(e.composition,t.uint32(50).fork()).ldelim(),null!=e.data&&e.hasOwnProperty("data")&&t.uint32(58).bytes(e.data),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Frame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.timecode=e.int64();break;case 2:n.pts=e.int64();break;case 3:n.timestamp=e.int64();break;case 4:n.sendingTime=e.int64();break;case 5:n.startIngestTime=e.int64();break;case 6:n.composition=$root.genvid.proto.Composition.decode(e,e.uint32());break;case 7:n.data=e.bytes();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timecode&&e.hasOwnProperty("timecode")&&!($util.isInteger(e.timecode)||e.timecode&&$util.isInteger(e.timecode.low)&&$util.isInteger(e.timecode.high)))return"timecode: integer|Long expected";if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!($util.isInteger(e.timestamp)||e.timestamp&&$util.isInteger(e.timestamp.low)&&$util.isInteger(e.timestamp.high)))return"timestamp: integer|Long expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high)))return"startIngestTime: integer|Long expected";if(null!=e.composition&&e.hasOwnProperty("composition")){var t=$root.genvid.proto.Composition.verify(e.composition);if(t)return"composition."+t}return null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||$util.isString(e.data))?"data: buffer expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Frame)return e;var t=new $root.genvid.proto.Frame;if(null!=e.timecode&&($util.Long?(t.timecode=$util.Long.fromValue(e.timecode)).unsigned=!1:"string"==typeof e.timecode?t.timecode=parseInt(e.timecode,10):"number"==typeof e.timecode?t.timecode=e.timecode:"object"==typeof e.timecode&&(t.timecode=new $util.LongBits(e.timecode.low>>>0,e.timecode.high>>>0).toNumber())),null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.timestamp&&($util.Long?(t.timestamp=$util.Long.fromValue(e.timestamp)).unsigned=!1:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),null!=e.composition){if("object"!=typeof e.composition)throw TypeError(".genvid.proto.Frame.composition: object expected");t.composition=$root.genvid.proto.Composition.fromObject(e.composition)}return null!=e.data&&("string"==typeof e.data?$util.base64.decode(e.data,t.data=$util.newBuffer($util.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.timecode=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.timecode=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.pts=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.timestamp=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0,r.composition=null,t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=$util.newBuffer(r.data)))}return null!=e.timecode&&e.hasOwnProperty("timecode")&&("number"==typeof e.timecode?r.timecode=t.longs===String?String(e.timecode):e.timecode:r.timecode=t.longs===String?$util.Long.prototype.toString.call(e.timecode):t.longs===Number?new $util.LongBits(e.timecode.low>>>0,e.timecode.high>>>0).toNumber():e.timecode),null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?r.timestamp=t.longs===String?String(e.timestamp):e.timestamp:r.timestamp=t.longs===String?$util.Long.prototype.toString.call(e.timestamp):t.longs===Number?new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),null!=e.composition&&e.hasOwnProperty("composition")&&(r.composition=$root.genvid.proto.Composition.toObject(e.composition,t)),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?$util.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Composition=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.item=null,e.prototype.components=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.item&&e.hasOwnProperty("item")&&$root.genvid.proto.Item.encode(e.item,t.uint32(10).fork()).ldelim(),null!=e.components&&e.hasOwnProperty("components")&&$root.genvid.proto.Component.encode(e.components,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Composition;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.item=$root.genvid.proto.Item.decode(e,e.uint32());break;case 2:n.components=$root.genvid.proto.Component.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.item&&e.hasOwnProperty("item")&&(t=$root.genvid.proto.Item.verify(e.item))?"item."+t:null!=e.components&&e.hasOwnProperty("components")&&(t=$root.genvid.proto.Component.verify(e.components))?"components."+t:null;var t},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Composition)return e;var t=new $root.genvid.proto.Composition;if(null!=e.item){if("object"!=typeof e.item)throw TypeError(".genvid.proto.Composition.item: object expected");t.item=$root.genvid.proto.Item.fromObject(e.item)}if(null!=e.components){if("object"!=typeof e.components)throw TypeError(".genvid.proto.Composition.components: object expected");t.components=$root.genvid.proto.Component.fromObject(e.components)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.item=null,r.components=null),null!=e.item&&e.hasOwnProperty("item")&&(r.item=$root.genvid.proto.Item.toObject(e.item,t)),null!=e.components&&e.hasOwnProperty("components")&&(r.components=$root.genvid.proto.Component.toObject(e.components,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Component=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.item=null,e.prototype.affine=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.item&&e.hasOwnProperty("item")&&$root.genvid.proto.Item.encode(e.item,t.uint32(10).fork()).ldelim(),null!=e.affine&&e.hasOwnProperty("affine")&&$root.genvid.proto.Affine.encode(e.affine,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Component;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.item=$root.genvid.proto.Item.decode(e,e.uint32());break;case 2:n.affine=$root.genvid.proto.Affine.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.item&&e.hasOwnProperty("item")&&(t=$root.genvid.proto.Item.verify(e.item))?"item."+t:null!=e.affine&&e.hasOwnProperty("affine")&&(t=$root.genvid.proto.Affine.verify(e.affine))?"affine."+t:null;var t},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Component)return e;var t=new $root.genvid.proto.Component;if(null!=e.item){if("object"!=typeof e.item)throw TypeError(".genvid.proto.Component.item: object expected");t.item=$root.genvid.proto.Item.fromObject(e.item)}if(null!=e.affine){if("object"!=typeof e.affine)throw TypeError(".genvid.proto.Component.affine: object expected");t.affine=$root.genvid.proto.Affine.fromObject(e.affine)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.item=null,r.affine=null),null!=e.item&&e.hasOwnProperty("item")&&(r.item=$root.genvid.proto.Item.toObject(e.item,t)),null!=e.affine&&e.hasOwnProperty("affine")&&(r.affine=$root.genvid.proto.Affine.toObject(e.affine,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Item=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sessionid=0,e.prototype.streamid=0,e.prototype.classname="",e.prototype.sourceid=0,e.prototype.videoSourceCompositionType="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(8).int64(e.timestamp),null!=e.sessionid&&e.hasOwnProperty("sessionid")&&t.uint32(16).uint32(e.sessionid),null!=e.streamid&&e.hasOwnProperty("streamid")&&t.uint32(24).int32(e.streamid),null!=e.classname&&e.hasOwnProperty("classname")&&t.uint32(34).string(e.classname),null!=e.sourceid&&e.hasOwnProperty("sourceid")&&t.uint32(40).uint32(e.sourceid),null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&t.uint32(50).string(e.videoSourceCompositionType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Item;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.timestamp=e.int64();break;case 2:n.sessionid=e.uint32();break;case 3:n.streamid=e.int32();break;case 4:n.classname=e.string();break;case 5:n.sourceid=e.uint32();break;case 6:n.videoSourceCompositionType=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!($util.isInteger(e.timestamp)||e.timestamp&&$util.isInteger(e.timestamp.low)&&$util.isInteger(e.timestamp.high))?"timestamp: integer|Long expected":null!=e.sessionid&&e.hasOwnProperty("sessionid")&&!$util.isInteger(e.sessionid)?"sessionid: integer expected":null!=e.streamid&&e.hasOwnProperty("streamid")&&!$util.isInteger(e.streamid)?"streamid: integer expected":null!=e.classname&&e.hasOwnProperty("classname")&&!$util.isString(e.classname)?"classname: string expected":null!=e.sourceid&&e.hasOwnProperty("sourceid")&&!$util.isInteger(e.sourceid)?"sourceid: integer expected":null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&!$util.isString(e.videoSourceCompositionType)?"videoSourceCompositionType: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Item)return e;var t=new $root.genvid.proto.Item;return null!=e.timestamp&&($util.Long?(t.timestamp=$util.Long.fromValue(e.timestamp)).unsigned=!1:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),null!=e.sessionid&&(t.sessionid=e.sessionid>>>0),null!=e.streamid&&(t.streamid=0|e.streamid),null!=e.classname&&(t.classname=String(e.classname)),null!=e.sourceid&&(t.sourceid=e.sourceid>>>0),null!=e.videoSourceCompositionType&&(t.videoSourceCompositionType=String(e.videoSourceCompositionType)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.timestamp=t.longs===String?"0":0;r.sessionid=0,r.streamid=0,r.classname="",r.sourceid=0,r.videoSourceCompositionType=""}return null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?r.timestamp=t.longs===String?String(e.timestamp):e.timestamp:r.timestamp=t.longs===String?$util.Long.prototype.toString.call(e.timestamp):t.longs===Number?new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),null!=e.sessionid&&e.hasOwnProperty("sessionid")&&(r.sessionid=e.sessionid),null!=e.streamid&&e.hasOwnProperty("streamid")&&(r.streamid=e.streamid),null!=e.classname&&e.hasOwnProperty("classname")&&(r.classname=e.classname),null!=e.sourceid&&e.hasOwnProperty("sourceid")&&(r.sourceid=e.sourceid),null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&(r.videoSourceCompositionType=e.videoSourceCompositionType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Affine=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.source=null,e.prototype.matrix=null,e.prototype.opacity=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.source&&e.hasOwnProperty("source")&&$root.genvid.proto.Item.encode(e.source,t.uint32(10).fork()).ldelim(),null!=e.matrix&&e.hasOwnProperty("matrix")&&$root.genvid.proto.Matrix3.encode(e.matrix,t.uint32(18).fork()).ldelim(),null!=e.opacity&&e.hasOwnProperty("opacity")&&t.uint32(29).float(e.opacity),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Affine;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.source=$root.genvid.proto.Item.decode(e,e.uint32());break;case 2:n.matrix=$root.genvid.proto.Matrix3.decode(e,e.uint32());break;case 3:n.opacity=e.float();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.source&&e.hasOwnProperty("source")&&(t=$root.genvid.proto.Item.verify(e.source))?"source."+t:null!=e.matrix&&e.hasOwnProperty("matrix")&&(t=$root.genvid.proto.Matrix3.verify(e.matrix))?"matrix."+t:null!=e.opacity&&e.hasOwnProperty("opacity")&&"number"!=typeof e.opacity?"opacity: number expected":null;var t},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Affine)return e;var t=new $root.genvid.proto.Affine;if(null!=e.source){if("object"!=typeof e.source)throw TypeError(".genvid.proto.Affine.source: object expected");t.source=$root.genvid.proto.Item.fromObject(e.source)}if(null!=e.matrix){if("object"!=typeof e.matrix)throw TypeError(".genvid.proto.Affine.matrix: object expected");t.matrix=$root.genvid.proto.Matrix3.fromObject(e.matrix)}return null!=e.opacity&&(t.opacity=Number(e.opacity)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.source=null,r.matrix=null,r.opacity=0),null!=e.source&&e.hasOwnProperty("source")&&(r.source=$root.genvid.proto.Item.toObject(e.source,t)),null!=e.matrix&&e.hasOwnProperty("matrix")&&(r.matrix=$root.genvid.proto.Matrix3.toObject(e.matrix,t)),null!=e.opacity&&e.hasOwnProperty("opacity")&&(r.opacity=t.json&&!isFinite(e.opacity)?String(e.opacity):e.opacity),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Matrix3=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.c0r0=0,e.prototype.c0r1=0,e.prototype.c0r2=0,e.prototype.c1r0=0,e.prototype.c1r1=0,e.prototype.c1r2=0,e.prototype.c2r0=0,e.prototype.c2r1=0,e.prototype.c2r2=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.c0r0&&e.hasOwnProperty("c0r0")&&t.uint32(13).float(e.c0r0),null!=e.c0r1&&e.hasOwnProperty("c0r1")&&t.uint32(21).float(e.c0r1),null!=e.c0r2&&e.hasOwnProperty("c0r2")&&t.uint32(29).float(e.c0r2),null!=e.c1r0&&e.hasOwnProperty("c1r0")&&t.uint32(37).float(e.c1r0),null!=e.c1r1&&e.hasOwnProperty("c1r1")&&t.uint32(45).float(e.c1r1),null!=e.c1r2&&e.hasOwnProperty("c1r2")&&t.uint32(53).float(e.c1r2),null!=e.c2r0&&e.hasOwnProperty("c2r0")&&t.uint32(61).float(e.c2r0),null!=e.c2r1&&e.hasOwnProperty("c2r1")&&t.uint32(69).float(e.c2r1),null!=e.c2r2&&e.hasOwnProperty("c2r2")&&t.uint32(77).float(e.c2r2),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Matrix3;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.c0r0=e.float();break;case 2:n.c0r1=e.float();break;case 3:n.c0r2=e.float();break;case 4:n.c1r0=e.float();break;case 5:n.c1r1=e.float();break;case 6:n.c1r2=e.float();break;case 7:n.c2r0=e.float();break;case 8:n.c2r1=e.float();break;case 9:n.c2r2=e.float();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.c0r0&&e.hasOwnProperty("c0r0")&&"number"!=typeof e.c0r0?"c0r0: number expected":null!=e.c0r1&&e.hasOwnProperty("c0r1")&&"number"!=typeof e.c0r1?"c0r1: number expected":null!=e.c0r2&&e.hasOwnProperty("c0r2")&&"number"!=typeof e.c0r2?"c0r2: number expected":null!=e.c1r0&&e.hasOwnProperty("c1r0")&&"number"!=typeof e.c1r0?"c1r0: number expected":null!=e.c1r1&&e.hasOwnProperty("c1r1")&&"number"!=typeof e.c1r1?"c1r1: number expected":null!=e.c1r2&&e.hasOwnProperty("c1r2")&&"number"!=typeof e.c1r2?"c1r2: number expected":null!=e.c2r0&&e.hasOwnProperty("c2r0")&&"number"!=typeof e.c2r0?"c2r0: number expected":null!=e.c2r1&&e.hasOwnProperty("c2r1")&&"number"!=typeof e.c2r1?"c2r1: number expected":null!=e.c2r2&&e.hasOwnProperty("c2r2")&&"number"!=typeof e.c2r2?"c2r2: number expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Matrix3)return e;var t=new $root.genvid.proto.Matrix3;return null!=e.c0r0&&(t.c0r0=Number(e.c0r0)),null!=e.c0r1&&(t.c0r1=Number(e.c0r1)),null!=e.c0r2&&(t.c0r2=Number(e.c0r2)),null!=e.c1r0&&(t.c1r0=Number(e.c1r0)),null!=e.c1r1&&(t.c1r1=Number(e.c1r1)),null!=e.c1r2&&(t.c1r2=Number(e.c1r2)),null!=e.c2r0&&(t.c2r0=Number(e.c2r0)),null!=e.c2r1&&(t.c2r1=Number(e.c2r1)),null!=e.c2r2&&(t.c2r2=Number(e.c2r2)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.c0r0=0,r.c0r1=0,r.c0r2=0,r.c1r0=0,r.c1r1=0,r.c1r2=0,r.c2r0=0,r.c2r1=0,r.c2r2=0),null!=e.c0r0&&e.hasOwnProperty("c0r0")&&(r.c0r0=t.json&&!isFinite(e.c0r0)?String(e.c0r0):e.c0r0),null!=e.c0r1&&e.hasOwnProperty("c0r1")&&(r.c0r1=t.json&&!isFinite(e.c0r1)?String(e.c0r1):e.c0r1),null!=e.c0r2&&e.hasOwnProperty("c0r2")&&(r.c0r2=t.json&&!isFinite(e.c0r2)?String(e.c0r2):e.c0r2),null!=e.c1r0&&e.hasOwnProperty("c1r0")&&(r.c1r0=t.json&&!isFinite(e.c1r0)?String(e.c1r0):e.c1r0),null!=e.c1r1&&e.hasOwnProperty("c1r1")&&(r.c1r1=t.json&&!isFinite(e.c1r1)?String(e.c1r1):e.c1r1),null!=e.c1r2&&e.hasOwnProperty("c1r2")&&(r.c1r2=t.json&&!isFinite(e.c1r2)?String(e.c1r2):e.c1r2),null!=e.c2r0&&e.hasOwnProperty("c2r0")&&(r.c2r0=t.json&&!isFinite(e.c2r0)?String(e.c2r0):e.c2r0),null!=e.c2r1&&e.hasOwnProperty("c2r1")&&(r.c2r1=t.json&&!isFinite(e.c2r1)?String(e.c2r1):e.c2r1),null!=e.c2r2&&e.hasOwnProperty("c2r2")&&(r.c2r2=t.json&&!isFinite(e.c2r2)?String(e.c2r2):e.c2r2),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.DataNotifications=function(){function e(e){if(this.notifications=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.notifications=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.notifications&&e.notifications.length)for(var r=0;r<e.notifications.length;++r)$root.genvid.proto.DataNotification.encode(e.notifications[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.DataNotifications;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.notifications&&n.notifications.length||(n.notifications=[]),n.notifications.push($root.genvid.proto.DataNotification.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.notifications&&e.hasOwnProperty("notifications")){if(!Array.isArray(e.notifications))return"notifications: array expected";for(var t=0;t<e.notifications.length;++t){var r=$root.genvid.proto.DataNotification.verify(e.notifications[t]);if(r)return"notifications."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.DataNotifications)return e;var t=new $root.genvid.proto.DataNotifications;if(e.notifications){if(!Array.isArray(e.notifications))throw TypeError(".genvid.proto.DataNotifications.notifications: array expected");t.notifications=[];for(var r=0;r<e.notifications.length;++r){if("object"!=typeof e.notifications[r])throw TypeError(".genvid.proto.DataNotifications.notifications: object expected");t.notifications[r]=$root.genvid.proto.DataNotification.fromObject(e.notifications[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.notifications=[]),e.notifications&&e.notifications.length){r.notifications=[];for(var n=0;n<e.notifications.length;++n)r.notifications[n]=$root.genvid.proto.DataNotification.toObject(e.notifications[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.DataNotification=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id="",e.prototype.data=$util.newBuffer([]),e.prototype.sessionid="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.id&&e.hasOwnProperty("id")&&t.uint32(10).string(e.id),null!=e.data&&e.hasOwnProperty("data")&&t.uint32(18).bytes(e.data),null!=e.sessionid&&e.hasOwnProperty("sessionid")&&t.uint32(26).string(e.sessionid),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.DataNotification;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.string();break;case 2:n.data=e.bytes();break;case 3:n.sessionid=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.id&&e.hasOwnProperty("id")&&!$util.isString(e.id)?"id: string expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||$util.isString(e.data))?"data: buffer expected":null!=e.sessionid&&e.hasOwnProperty("sessionid")&&!$util.isString(e.sessionid)?"sessionid: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.DataNotification)return e;var t=new $root.genvid.proto.DataNotification;return null!=e.id&&(t.id=String(e.id)),null!=e.data&&("string"==typeof e.data?$util.base64.decode(e.data,t.data=$util.newBuffer($util.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.sessionid&&(t.sessionid=String(e.sessionid)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.id="",t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=$util.newBuffer(r.data))),r.sessionid=""),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?$util.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.sessionid&&e.hasOwnProperty("sessionid")&&(r.sessionid=e.sessionid),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Event=function(){function e(e){if(this.keyValue=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.keyValue=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.keyValue&&e.keyValue.length)for(var r=0;r<e.keyValue.length;++r)$root.genvid.proto.KeyValue.encode(e.keyValue[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Event;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.keyValue&&n.keyValue.length||(n.keyValue=[]),n.keyValue.push($root.genvid.proto.KeyValue.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.keyValue&&e.hasOwnProperty("keyValue")){if(!Array.isArray(e.keyValue))return"keyValue: array expected";for(var t=0;t<e.keyValue.length;++t){var r=$root.genvid.proto.KeyValue.verify(e.keyValue[t]);if(r)return"keyValue."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Event)return e;var t=new $root.genvid.proto.Event;if(e.keyValue){if(!Array.isArray(e.keyValue))throw TypeError(".genvid.proto.Event.keyValue: array expected");t.keyValue=[];for(var r=0;r<e.keyValue.length;++r){if("object"!=typeof e.keyValue[r])throw TypeError(".genvid.proto.Event.keyValue: object expected");t.keyValue[r]=$root.genvid.proto.KeyValue.fromObject(e.keyValue[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.keyValue=[]),e.keyValue&&e.keyValue.length){r.keyValue=[];for(var n=0;n<e.keyValue.length;++n)r.keyValue[n]=$root.genvid.proto.KeyValue.toObject(e.keyValue[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.KeyValue=function(){function e(e){if(this.key=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key=$util.emptyArray,e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.key&&e.key.length)for(var r=0;r<e.key.length;++r)t.uint32(10).string(e.key[r]);return null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.KeyValue;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key&&n.key.length||(n.key=[]),n.key.push(e.string());break;case 2:n.value=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.key&&e.hasOwnProperty("key")){if(!Array.isArray(e.key))return"key: array expected";for(var t=0;t<e.key.length;++t)if(!$util.isString(e.key[t]))return"key: string[] expected"}return null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.KeyValue)return e;var t=new $root.genvid.proto.KeyValue;if(e.key){if(!Array.isArray(e.key))throw TypeError(".genvid.proto.KeyValue.key: array expected");t.key=[];for(var r=0;r<e.key.length;++r)t.key[r]=String(e.key[r])}return null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.key=[]),t.defaults&&(r.value=""),e.key&&e.key.length){r.key=[];for(var n=0;n<e.key.length;++n)r.key[n]=e.key[n]}return null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.ClientMetrics=function(){function e(e){if(this.clientMetrics=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.clientMetrics=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.clientMetrics&&e.clientMetrics.length)for(var r=0;r<e.clientMetrics.length;++r)$root.genvid.proto.ClientMetric.encode(e.clientMetrics[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.ClientMetrics;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.clientMetrics&&n.clientMetrics.length||(n.clientMetrics=[]),n.clientMetrics.push($root.genvid.proto.ClientMetric.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.clientMetrics&&e.hasOwnProperty("clientMetrics")){if(!Array.isArray(e.clientMetrics))return"clientMetrics: array expected";for(var t=0;t<e.clientMetrics.length;++t){var r=$root.genvid.proto.ClientMetric.verify(e.clientMetrics[t]);if(r)return"clientMetrics."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.ClientMetrics)return e;var t=new $root.genvid.proto.ClientMetrics;if(e.clientMetrics){if(!Array.isArray(e.clientMetrics))throw TypeError(".genvid.proto.ClientMetrics.clientMetrics: array expected");t.clientMetrics=[];for(var r=0;r<e.clientMetrics.length;++r){if("object"!=typeof e.clientMetrics[r])throw TypeError(".genvid.proto.ClientMetrics.clientMetrics: object expected");t.clientMetrics[r]=$root.genvid.proto.ClientMetric.fromObject(e.clientMetrics[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.clientMetrics=[]),e.clientMetrics&&e.clientMetrics.length){r.clientMetrics=[];for(var n=0;n<e.clientMetrics.length;++n)r.clientMetrics[n]=$root.genvid.proto.ClientMetric.toObject(e.clientMetrics[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.ClientMetric=function(){function e(e){if(this.tags=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value=0,e.prototype.tags=$util.emptyArray,e.prototype.operation="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(17).double(e.value),null!=e.tags&&e.tags.length)for(var r=0;r<e.tags.length;++r)t.uint32(26).string(e.tags[r]);return null!=e.operation&&e.hasOwnProperty("operation")&&t.uint32(34).string(e.operation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.ClientMetric;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.value=e.double();break;case 3:n.tags&&n.tags.length||(n.tags=[]),n.tags.push(e.string());break;case 4:n.operation=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key))return"key: string expected";if(null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value)return"value: number expected";if(null!=e.tags&&e.hasOwnProperty("tags")){if(!Array.isArray(e.tags))return"tags: array expected";for(var t=0;t<e.tags.length;++t)if(!$util.isString(e.tags[t]))return"tags: string[] expected"}return null!=e.operation&&e.hasOwnProperty("operation")&&!$util.isString(e.operation)?"operation: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.ClientMetric)return e;var t=new $root.genvid.proto.ClientMetric;if(null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),e.tags){if(!Array.isArray(e.tags))throw TypeError(".genvid.proto.ClientMetric.tags: array expected");t.tags=[];for(var r=0;r<e.tags.length;++r)t.tags[r]=String(e.tags[r])}return null!=e.operation&&(t.operation=String(e.operation)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.tags=[]),t.defaults&&(r.key="",r.value=0,r.operation=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.json&&!isFinite(e.value)?String(e.value):e.value),e.tags&&e.tags.length){r.tags=[];for(var n=0;n<e.tags.length;++n)r.tags[n]=e.tags[n]}return null!=e.operation&&e.hasOwnProperty("operation")&&(r.operation=e.operation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.LeafMethod=(e={},(t=Object.create(e))[e[0]="REPLY"]=0,t[e[2]="EVENT"]=2,t[e[3]="DATA_FRAMES"]=3,t[e[4]="DATA_NOTIFICATIONS"]=4,t[e[5]="CLIENT_METRICS"]=5,t[e[6]="METRICS_CONFIG"]=6,t[e[7]="STREAM_FORMAT"]=7,t),r.LeafEnvelope=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.method=0,e.prototype.params=$util.newBuffer([]),e.prototype.result=$util.newBuffer([]),e.prototype.error=null,e.prototype.id=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.method&&e.hasOwnProperty("method")&&t.uint32(8).int32(e.method),null!=e.params&&e.hasOwnProperty("params")&&t.uint32(18).bytes(e.params),null!=e.result&&e.hasOwnProperty("result")&&t.uint32(26).bytes(e.result),null!=e.error&&e.hasOwnProperty("error")&&$root.genvid.proto.LeafError.encode(e.error,t.uint32(34).fork()).ldelim(),null!=e.id&&e.hasOwnProperty("id")&&t.uint32(40).int32(e.id),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.LeafEnvelope;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.method=e.int32();break;case 2:n.params=e.bytes();break;case 3:n.result=e.bytes();break;case 4:n.error=$root.genvid.proto.LeafError.decode(e,e.uint32());break;case 5:n.id=e.int32();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.method&&e.hasOwnProperty("method"))switch(e.method){default:return"method: enum value expected";case 0:case 2:case 3:case 4:case 5:case 6:case 7:}if(null!=e.params&&e.hasOwnProperty("params")&&!(e.params&&"number"==typeof e.params.length||$util.isString(e.params)))return"params: buffer expected";if(null!=e.result&&e.hasOwnProperty("result")&&!(e.result&&"number"==typeof e.result.length||$util.isString(e.result)))return"result: buffer expected";if(null!=e.error&&e.hasOwnProperty("error")){var t=$root.genvid.proto.LeafError.verify(e.error);if(t)return"error."+t}return null!=e.id&&e.hasOwnProperty("id")&&!$util.isInteger(e.id)?"id: integer expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.LeafEnvelope)return e;var t=new $root.genvid.proto.LeafEnvelope;switch(e.method){case"REPLY":case 0:t.method=0;break;case"EVENT":case 2:t.method=2;break;case"DATA_FRAMES":case 3:t.method=3;break;case"DATA_NOTIFICATIONS":case 4:t.method=4;break;case"CLIENT_METRICS":case 5:t.method=5;break;case"METRICS_CONFIG":case 6:t.method=6;break;case"STREAM_FORMAT":case 7:t.method=7}if(null!=e.params&&("string"==typeof e.params?$util.base64.decode(e.params,t.params=$util.newBuffer($util.base64.length(e.params)),0):e.params.length&&(t.params=e.params)),null!=e.result&&("string"==typeof e.result?$util.base64.decode(e.result,t.result=$util.newBuffer($util.base64.length(e.result)),0):e.result.length&&(t.result=e.result)),null!=e.error){if("object"!=typeof e.error)throw TypeError(".genvid.proto.LeafEnvelope.error: object expected");t.error=$root.genvid.proto.LeafError.fromObject(e.error)}return null!=e.id&&(t.id=0|e.id),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.method=t.enums===String?"REPLY":0,t.bytes===String?r.params="":(r.params=[],t.bytes!==Array&&(r.params=$util.newBuffer(r.params))),t.bytes===String?r.result="":(r.result=[],t.bytes!==Array&&(r.result=$util.newBuffer(r.result))),r.error=null,r.id=0),null!=e.method&&e.hasOwnProperty("method")&&(r.method=t.enums===String?$root.genvid.proto.LeafMethod[e.method]:e.method),null!=e.params&&e.hasOwnProperty("params")&&(r.params=t.bytes===String?$util.base64.encode(e.params,0,e.params.length):t.bytes===Array?Array.prototype.slice.call(e.params):e.params),null!=e.result&&e.hasOwnProperty("result")&&(r.result=t.bytes===String?$util.base64.encode(e.result,0,e.result.length):t.bytes===Array?Array.prototype.slice.call(e.result):e.result),null!=e.error&&e.hasOwnProperty("error")&&(r.error=$root.genvid.proto.LeafError.toObject(e.error,t)),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.LeafError=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.code=0,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(8).int32(e.code),null!=e.message&&e.hasOwnProperty("message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.LeafError;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.code=e.int32();break;case 2:n.message=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null!=e.message&&e.hasOwnProperty("message")&&!$util.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.LeafError)return e;var t=new $root.genvid.proto.LeafError;return null!=e.code&&(t.code=0|e.code),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.code=0,r.message=""),null!=e.code&&e.hasOwnProperty("code")&&(r.code=e.code),null!=e.message&&e.hasOwnProperty("message")&&(r.message=e.message),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.MetricsConfig=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.periodSeconds=0,e.prototype.enabled=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.periodSeconds&&e.hasOwnProperty("periodSeconds")&&t.uint32(8).uint32(e.periodSeconds),null!=e.enabled&&e.hasOwnProperty("enabled")&&t.uint32(16).bool(e.enabled),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.MetricsConfig;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.periodSeconds=e.uint32();break;case 2:n.enabled=e.bool();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.periodSeconds&&e.hasOwnProperty("periodSeconds")&&!$util.isInteger(e.periodSeconds)?"periodSeconds: integer expected":null!=e.enabled&&e.hasOwnProperty("enabled")&&"boolean"!=typeof e.enabled?"enabled: boolean expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.MetricsConfig)return e;var t=new $root.genvid.proto.MetricsConfig;return null!=e.periodSeconds&&(t.periodSeconds=e.periodSeconds>>>0),null!=e.enabled&&(t.enabled=Boolean(e.enabled)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.periodSeconds=0,r.enabled=!1),null!=e.periodSeconds&&e.hasOwnProperty("periodSeconds")&&(r.periodSeconds=e.periodSeconds),null!=e.enabled&&e.hasOwnProperty("enabled")&&(r.enabled=e.enabled),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.FrameStatus=function(){function e(e){if(this.sources=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.frameNum=0,e.prototype.reason=0,e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.encodingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.packetSize=0,e.prototype.timestamp=0,e.prototype.duration=0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.composition=null,e.prototype.sources=$util.emptyArray,e.prototype.encodedTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.frameNum&&e.hasOwnProperty("frameNum")&&t.uint32(8).int32(e.frameNum),null!=e.reason&&e.hasOwnProperty("reason")&&t.uint32(16).int32(e.reason),null!=e.pts&&e.hasOwnProperty("pts")&&t.uint32(24).int64(e.pts),null!=e.encodingTime&&e.hasOwnProperty("encodingTime")&&t.uint32(32).int64(e.encodingTime),null!=e.packetSize&&e.hasOwnProperty("packetSize")&&t.uint32(40).int32(e.packetSize),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(49).double(e.timestamp),null!=e.duration&&e.hasOwnProperty("duration")&&t.uint32(57).double(e.duration),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&t.uint32(64).int64(e.sendingTime),null!=e.composition&&e.hasOwnProperty("composition")&&$root.genvid.proto.CompositionNode.encode(e.composition,t.uint32(74).fork()).ldelim(),null!=e.sources&&e.sources.length)for(var r=0;r<e.sources.length;++r)$root.genvid.proto.SyncSource.encode(e.sources[r],t.uint32(82).fork()).ldelim();return null!=e.encodedTime&&e.hasOwnProperty("encodedTime")&&t.uint32(88).int64(e.encodedTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&t.uint32(96).int64(e.startIngestTime),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.FrameStatus;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.frameNum=e.int32();break;case 2:n.reason=e.int32();break;case 3:n.pts=e.int64();break;case 4:n.encodingTime=e.int64();break;case 5:n.packetSize=e.int32();break;case 6:n.timestamp=e.double();break;case 7:n.duration=e.double();break;case 8:n.sendingTime=e.int64();break;case 9:n.composition=$root.genvid.proto.CompositionNode.decode(e,e.uint32());break;case 10:n.sources&&n.sources.length||(n.sources=[]),n.sources.push($root.genvid.proto.SyncSource.decode(e,e.uint32()));break;case 11:n.encodedTime=e.int64();break;case 12:n.startIngestTime=e.int64();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.frameNum&&e.hasOwnProperty("frameNum")&&!$util.isInteger(e.frameNum))return"frameNum: integer expected";if(null!=e.reason&&e.hasOwnProperty("reason"))switch(e.reason){default:return"reason: enum value expected";case 0:case 1:case 2:}if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.encodingTime&&e.hasOwnProperty("encodingTime")&&!($util.isInteger(e.encodingTime)||e.encodingTime&&$util.isInteger(e.encodingTime.low)&&$util.isInteger(e.encodingTime.high)))return"encodingTime: integer|Long expected";if(null!=e.packetSize&&e.hasOwnProperty("packetSize")&&!$util.isInteger(e.packetSize))return"packetSize: integer expected";if(null!=e.timestamp&&e.hasOwnProperty("timestamp")&&"number"!=typeof e.timestamp)return"timestamp: number expected";if(null!=e.duration&&e.hasOwnProperty("duration")&&"number"!=typeof e.duration)return"duration: number expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.composition&&e.hasOwnProperty("composition")&&(r=$root.genvid.proto.CompositionNode.verify(e.composition)))return"composition."+r;if(null!=e.sources&&e.hasOwnProperty("sources")){if(!Array.isArray(e.sources))return"sources: array expected";for(var t=0;t<e.sources.length;++t){var r;if(r=$root.genvid.proto.SyncSource.verify(e.sources[t]))return"sources."+r}}return null!=e.encodedTime&&e.hasOwnProperty("encodedTime")&&!($util.isInteger(e.encodedTime)||e.encodedTime&&$util.isInteger(e.encodedTime.low)&&$util.isInteger(e.encodedTime.high))?"encodedTime: integer|Long expected":null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high))?"startIngestTime: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.FrameStatus)return e;var t=new $root.genvid.proto.FrameStatus;switch(null!=e.frameNum&&(t.frameNum=0|e.frameNum),e.reason){case"VIDEOFRAMEENCODED":case 0:t.reason=0;break;case"IDLE":case 1:t.reason=1;break;case"UNDEFINEDEREASON":case 2:t.reason=2}if(null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.encodingTime&&($util.Long?(t.encodingTime=$util.Long.fromValue(e.encodingTime)).unsigned=!1:"string"==typeof e.encodingTime?t.encodingTime=parseInt(e.encodingTime,10):"number"==typeof e.encodingTime?t.encodingTime=e.encodingTime:"object"==typeof e.encodingTime&&(t.encodingTime=new $util.LongBits(e.encodingTime.low>>>0,e.encodingTime.high>>>0).toNumber())),null!=e.packetSize&&(t.packetSize=0|e.packetSize),null!=e.timestamp&&(t.timestamp=Number(e.timestamp)),null!=e.duration&&(t.duration=Number(e.duration)),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.composition){if("object"!=typeof e.composition)throw TypeError(".genvid.proto.FrameStatus.composition: object expected");t.composition=$root.genvid.proto.CompositionNode.fromObject(e.composition)}if(e.sources){if(!Array.isArray(e.sources))throw TypeError(".genvid.proto.FrameStatus.sources: array expected");t.sources=[];for(var r=0;r<e.sources.length;++r){if("object"!=typeof e.sources[r])throw TypeError(".genvid.proto.FrameStatus.sources: object expected");t.sources[r]=$root.genvid.proto.SyncSource.fromObject(e.sources[r])}}return null!=e.encodedTime&&($util.Long?(t.encodedTime=$util.Long.fromValue(e.encodedTime)).unsigned=!1:"string"==typeof e.encodedTime?t.encodedTime=parseInt(e.encodedTime,10):"number"==typeof e.encodedTime?t.encodedTime=e.encodedTime:"object"==typeof e.encodedTime&&(t.encodedTime=new $util.LongBits(e.encodedTime.low>>>0,e.encodedTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.sources=[]),t.defaults){if(r.frameNum=0,r.reason=t.enums===String?"VIDEOFRAMEENCODED":0,$util.Long){var n=new $util.Long(0,0,!1);r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.pts=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.encodingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.encodingTime=t.longs===String?"0":0,r.packetSize=0,r.timestamp=0,r.duration=0,$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,r.composition=null,$util.Long?(n=new $util.Long(0,0,!1),r.encodedTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.encodedTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0}if(null!=e.frameNum&&e.hasOwnProperty("frameNum")&&(r.frameNum=e.frameNum),null!=e.reason&&e.hasOwnProperty("reason")&&(r.reason=t.enums===String?$root.genvid.proto.Reason[e.reason]:e.reason),null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.encodingTime&&e.hasOwnProperty("encodingTime")&&("number"==typeof e.encodingTime?r.encodingTime=t.longs===String?String(e.encodingTime):e.encodingTime:r.encodingTime=t.longs===String?$util.Long.prototype.toString.call(e.encodingTime):t.longs===Number?new $util.LongBits(e.encodingTime.low>>>0,e.encodingTime.high>>>0).toNumber():e.encodingTime),null!=e.packetSize&&e.hasOwnProperty("packetSize")&&(r.packetSize=e.packetSize),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&(r.timestamp=t.json&&!isFinite(e.timestamp)?String(e.timestamp):e.timestamp),null!=e.duration&&e.hasOwnProperty("duration")&&(r.duration=t.json&&!isFinite(e.duration)?String(e.duration):e.duration),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.composition&&e.hasOwnProperty("composition")&&(r.composition=$root.genvid.proto.CompositionNode.toObject(e.composition,t)),e.sources&&e.sources.length){r.sources=[];for(var i=0;i<e.sources.length;++i)r.sources[i]=$root.genvid.proto.SyncSource.toObject(e.sources[i],t)}return null!=e.encodedTime&&e.hasOwnProperty("encodedTime")&&("number"==typeof e.encodedTime?r.encodedTime=t.longs===String?String(e.encodedTime):e.encodedTime:r.encodedTime=t.longs===String?$util.Long.prototype.toString.call(e.encodedTime):t.longs===Number?new $util.LongBits(e.encodedTime.low>>>0,e.encodedTime.high>>>0).toNumber():e.encodedTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.CompositionFrame=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.composition=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.pts&&e.hasOwnProperty("pts")&&t.uint32(8).int64(e.pts),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&t.uint32(16).int64(e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&t.uint32(24).int64(e.startIngestTime),null!=e.composition&&e.hasOwnProperty("composition")&&$root.genvid.proto.CompositionNode.encode(e.composition,t.uint32(34).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.CompositionFrame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.pts=e.int64();break;case 2:n.sendingTime=e.int64();break;case 3:n.startIngestTime=e.int64();break;case 4:n.composition=$root.genvid.proto.CompositionNode.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high)))return"startIngestTime: integer|Long expected";if(null!=e.composition&&e.hasOwnProperty("composition")){var t=$root.genvid.proto.CompositionNode.verify(e.composition);if(t)return"composition."+t}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.CompositionFrame)return e;var t=new $root.genvid.proto.CompositionFrame;if(null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),null!=e.composition){if("object"!=typeof e.composition)throw TypeError(".genvid.proto.CompositionFrame.composition: object expected");t.composition=$root.genvid.proto.CompositionNode.fromObject(e.composition)}return t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.pts=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0,r.composition=null}return null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),null!=e.composition&&e.hasOwnProperty("composition")&&(r.composition=$root.genvid.proto.CompositionNode.toObject(e.composition,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.SyncSource=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sessionId=0,e.prototype.streamId=0,e.prototype.timestamp=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&t.uint32(8).uint32(e.sessionId),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(16).uint32(e.streamId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&t.uint32(25).double(e.timestamp),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.SyncSource;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sessionId=e.uint32();break;case 2:n.streamId=e.uint32();break;case 3:n.timestamp=e.double();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isInteger(e.sessionId)?"sessionId: integer expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!$util.isInteger(e.streamId)?"streamId: integer expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&"number"!=typeof e.timestamp?"timestamp: number expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.SyncSource)return e;var t=new $root.genvid.proto.SyncSource;return null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.timestamp&&(t.timestamp=Number(e.timestamp)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.sessionId=0,r.streamId=0,r.timestamp=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),null!=e.streamId&&e.hasOwnProperty("streamId")&&(r.streamId=e.streamId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&(r.timestamp=t.json&&!isFinite(e.timestamp)?String(e.timestamp):e.timestamp),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.SyncFrame=function(){function e(e){if(this.sources=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.syncTime=0,e.prototype.sources=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.pts&&e.hasOwnProperty("pts")&&t.uint32(8).int64(e.pts),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&t.uint32(16).int64(e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&t.uint32(24).int64(e.startIngestTime),null!=e.syncTime&&e.hasOwnProperty("syncTime")&&t.uint32(32).int32(e.syncTime),null!=e.sources&&e.sources.length)for(var r=0;r<e.sources.length;++r)$root.genvid.proto.SyncSource.encode(e.sources[r],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.SyncFrame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.pts=e.int64();break;case 2:n.sendingTime=e.int64();break;case 3:n.startIngestTime=e.int64();break;case 4:n.syncTime=e.int32();break;case 5:n.sources&&n.sources.length||(n.sources=[]),n.sources.push($root.genvid.proto.SyncSource.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high)))return"startIngestTime: integer|Long expected";if(null!=e.syncTime&&e.hasOwnProperty("syncTime")&&!$util.isInteger(e.syncTime))return"syncTime: integer expected";if(null!=e.sources&&e.hasOwnProperty("sources")){if(!Array.isArray(e.sources))return"sources: array expected";for(var t=0;t<e.sources.length;++t){var r=$root.genvid.proto.SyncSource.verify(e.sources[t]);if(r)return"sources."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.SyncFrame)return e;var t=new $root.genvid.proto.SyncFrame;if(null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),null!=e.syncTime&&(t.syncTime=0|e.syncTime),e.sources){if(!Array.isArray(e.sources))throw TypeError(".genvid.proto.SyncFrame.sources: array expected");t.sources=[];for(var r=0;r<e.sources.length;++r){if("object"!=typeof e.sources[r])throw TypeError(".genvid.proto.SyncFrame.sources: object expected");t.sources[r]=$root.genvid.proto.SyncSource.fromObject(e.sources[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.sources=[]),t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.pts=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0,r.syncTime=0}if(null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),null!=e.syncTime&&e.hasOwnProperty("syncTime")&&(r.syncTime=e.syncTime),e.sources&&e.sources.length){r.sources=[];for(var i=0;i<e.sources.length;++i)r.sources[i]=$root.genvid.proto.SyncSource.toObject(e.sources[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Mat3=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.c0r0=0,e.prototype.c0r1=0,e.prototype.c0r2=0,e.prototype.c1r0=0,e.prototype.c1r1=0,e.prototype.c1r2=0,e.prototype.c2r0=0,e.prototype.c2r1=0,e.prototype.c2r2=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.c0r0&&e.hasOwnProperty("c0r0")&&t.uint32(13).float(e.c0r0),null!=e.c0r1&&e.hasOwnProperty("c0r1")&&t.uint32(21).float(e.c0r1),null!=e.c0r2&&e.hasOwnProperty("c0r2")&&t.uint32(29).float(e.c0r2),null!=e.c1r0&&e.hasOwnProperty("c1r0")&&t.uint32(37).float(e.c1r0),null!=e.c1r1&&e.hasOwnProperty("c1r1")&&t.uint32(45).float(e.c1r1),null!=e.c1r2&&e.hasOwnProperty("c1r2")&&t.uint32(53).float(e.c1r2),null!=e.c2r0&&e.hasOwnProperty("c2r0")&&t.uint32(61).float(e.c2r0),null!=e.c2r1&&e.hasOwnProperty("c2r1")&&t.uint32(69).float(e.c2r1),null!=e.c2r2&&e.hasOwnProperty("c2r2")&&t.uint32(77).float(e.c2r2),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Mat3;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.c0r0=e.float();break;case 2:n.c0r1=e.float();break;case 3:n.c0r2=e.float();break;case 4:n.c1r0=e.float();break;case 5:n.c1r1=e.float();break;case 6:n.c1r2=e.float();break;case 7:n.c2r0=e.float();break;case 8:n.c2r1=e.float();break;case 9:n.c2r2=e.float();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.c0r0&&e.hasOwnProperty("c0r0")&&"number"!=typeof e.c0r0?"c0r0: number expected":null!=e.c0r1&&e.hasOwnProperty("c0r1")&&"number"!=typeof e.c0r1?"c0r1: number expected":null!=e.c0r2&&e.hasOwnProperty("c0r2")&&"number"!=typeof e.c0r2?"c0r2: number expected":null!=e.c1r0&&e.hasOwnProperty("c1r0")&&"number"!=typeof e.c1r0?"c1r0: number expected":null!=e.c1r1&&e.hasOwnProperty("c1r1")&&"number"!=typeof e.c1r1?"c1r1: number expected":null!=e.c1r2&&e.hasOwnProperty("c1r2")&&"number"!=typeof e.c1r2?"c1r2: number expected":null!=e.c2r0&&e.hasOwnProperty("c2r0")&&"number"!=typeof e.c2r0?"c2r0: number expected":null!=e.c2r1&&e.hasOwnProperty("c2r1")&&"number"!=typeof e.c2r1?"c2r1: number expected":null!=e.c2r2&&e.hasOwnProperty("c2r2")&&"number"!=typeof e.c2r2?"c2r2: number expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Mat3)return e;var t=new $root.genvid.proto.Mat3;return null!=e.c0r0&&(t.c0r0=Number(e.c0r0)),null!=e.c0r1&&(t.c0r1=Number(e.c0r1)),null!=e.c0r2&&(t.c0r2=Number(e.c0r2)),null!=e.c1r0&&(t.c1r0=Number(e.c1r0)),null!=e.c1r1&&(t.c1r1=Number(e.c1r1)),null!=e.c1r2&&(t.c1r2=Number(e.c1r2)),null!=e.c2r0&&(t.c2r0=Number(e.c2r0)),null!=e.c2r1&&(t.c2r1=Number(e.c2r1)),null!=e.c2r2&&(t.c2r2=Number(e.c2r2)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.c0r0=0,r.c0r1=0,r.c0r2=0,r.c1r0=0,r.c1r1=0,r.c1r2=0,r.c2r0=0,r.c2r1=0,r.c2r2=0),null!=e.c0r0&&e.hasOwnProperty("c0r0")&&(r.c0r0=t.json&&!isFinite(e.c0r0)?String(e.c0r0):e.c0r0),null!=e.c0r1&&e.hasOwnProperty("c0r1")&&(r.c0r1=t.json&&!isFinite(e.c0r1)?String(e.c0r1):e.c0r1),null!=e.c0r2&&e.hasOwnProperty("c0r2")&&(r.c0r2=t.json&&!isFinite(e.c0r2)?String(e.c0r2):e.c0r2),null!=e.c1r0&&e.hasOwnProperty("c1r0")&&(r.c1r0=t.json&&!isFinite(e.c1r0)?String(e.c1r0):e.c1r0),null!=e.c1r1&&e.hasOwnProperty("c1r1")&&(r.c1r1=t.json&&!isFinite(e.c1r1)?String(e.c1r1):e.c1r1),null!=e.c1r2&&e.hasOwnProperty("c1r2")&&(r.c1r2=t.json&&!isFinite(e.c1r2)?String(e.c1r2):e.c1r2),null!=e.c2r0&&e.hasOwnProperty("c2r0")&&(r.c2r0=t.json&&!isFinite(e.c2r0)?String(e.c2r0):e.c2r0),null!=e.c2r1&&e.hasOwnProperty("c2r1")&&(r.c2r1=t.json&&!isFinite(e.c2r1)?String(e.c2r1):e.c2r1),null!=e.c2r2&&e.hasOwnProperty("c2r2")&&(r.c2r2=t.json&&!isFinite(e.c2r2)?String(e.c2r2):e.c2r2),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.CompositionNode=function(){function e(e){if(this.children=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=0,e.prototype.sessionId=0,e.prototype.streamId=0,e.prototype.children=$util.emptyArray,e.prototype.source=null,e.prototype.affineMatrix=null,e.prototype.opacity=0,e.prototype.sourceId=0,e.prototype.videoSourceCompositionType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.type&&e.hasOwnProperty("type")&&t.uint32(8).int32(e.type),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&t.uint32(16).uint32(e.sessionId),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(24).uint32(e.streamId),null!=e.children&&e.children.length)for(var r=0;r<e.children.length;++r)$root.genvid.proto.CompositionNode.encode(e.children[r],t.uint32(42).fork()).ldelim();return null!=e.source&&e.hasOwnProperty("source")&&$root.genvid.proto.CompositionNode.encode(e.source,t.uint32(50).fork()).ldelim(),null!=e.affineMatrix&&e.hasOwnProperty("affineMatrix")&&$root.genvid.proto.Mat3.encode(e.affineMatrix,t.uint32(58).fork()).ldelim(),null!=e.opacity&&e.hasOwnProperty("opacity")&&t.uint32(69).float(e.opacity),null!=e.sourceId&&e.hasOwnProperty("sourceId")&&t.uint32(72).uint32(e.sourceId),null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&t.uint32(80).int32(e.videoSourceCompositionType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.CompositionNode;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.type=e.int32();break;case 2:n.sessionId=e.uint32();break;case 3:n.streamId=e.uint32();break;case 5:n.children&&n.children.length||(n.children=[]),n.children.push($root.genvid.proto.CompositionNode.decode(e,e.uint32()));break;case 6:n.source=$root.genvid.proto.CompositionNode.decode(e,e.uint32());break;case 7:n.affineMatrix=$root.genvid.proto.Mat3.decode(e,e.uint32());break;case 8:n.opacity=e.float();break;case 9:n.sourceId=e.uint32();break;case 10:n.videoSourceCompositionType=e.int32();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isInteger(e.sessionId))return"sessionId: integer expected";if(null!=e.streamId&&e.hasOwnProperty("streamId")&&!$util.isInteger(e.streamId))return"streamId: integer expected";if(null!=e.children&&e.hasOwnProperty("children")){if(!Array.isArray(e.children))return"children: array expected";for(var t=0;t<e.children.length;++t)if(r=$root.genvid.proto.CompositionNode.verify(e.children[t]))return"children."+r}var r;if(null!=e.source&&e.hasOwnProperty("source")&&(r=$root.genvid.proto.CompositionNode.verify(e.source)))return"source."+r;if(null!=e.affineMatrix&&e.hasOwnProperty("affineMatrix")&&(r=$root.genvid.proto.Mat3.verify(e.affineMatrix)))return"affineMatrix."+r;if(null!=e.opacity&&e.hasOwnProperty("opacity")&&"number"!=typeof e.opacity)return"opacity: number expected";if(null!=e.sourceId&&e.hasOwnProperty("sourceId")&&!$util.isInteger(e.sourceId))return"sourceId: integer expected";if(null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType"))switch(e.videoSourceCompositionType){default:return"videoSourceCompositionType: enum value expected";case 0:case 1:case 2:case 3:}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.CompositionNode)return e;var t=new $root.genvid.proto.CompositionNode;switch(e.type){case"DEFAULT":case 0:t.type=0;break;case"RTMSP":case 1:t.type=1;break;case"COMPOSITE":case 2:t.type=2;break;case"AFFINE":case 3:t.type=3;break;case"STILLIMAGE":case 4:t.type=4}if(null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.streamId&&(t.streamId=e.streamId>>>0),e.children){if(!Array.isArray(e.children))throw TypeError(".genvid.proto.CompositionNode.children: array expected");t.children=[];for(var r=0;r<e.children.length;++r){if("object"!=typeof e.children[r])throw TypeError(".genvid.proto.CompositionNode.children: object expected");t.children[r]=$root.genvid.proto.CompositionNode.fromObject(e.children[r])}}if(null!=e.source){if("object"!=typeof e.source)throw TypeError(".genvid.proto.CompositionNode.source: object expected");t.source=$root.genvid.proto.CompositionNode.fromObject(e.source)}if(null!=e.affineMatrix){if("object"!=typeof e.affineMatrix)throw TypeError(".genvid.proto.CompositionNode.affineMatrix: object expected");t.affineMatrix=$root.genvid.proto.Mat3.fromObject(e.affineMatrix)}switch(null!=e.opacity&&(t.opacity=Number(e.opacity)),null!=e.sourceId&&(t.sourceId=e.sourceId>>>0),e.videoSourceCompositionType){case"UNDEFINEDLAYOUT":case 0:t.videoSourceCompositionType=0;break;case"PIPVIDEOLAYOUT":case 1:t.videoSourceCompositionType=1;break;case"CHROMAKEYVIDEOLAYOUT":case 2:t.videoSourceCompositionType=2;break;case"NOTSET":case 3:t.videoSourceCompositionType=3}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.children=[]),t.defaults&&(r.type=t.enums===String?"DEFAULT":0,r.sessionId=0,r.streamId=0,r.source=null,r.affineMatrix=null,r.opacity=0,r.sourceId=0,r.videoSourceCompositionType=t.enums===String?"UNDEFINEDLAYOUT":0),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?$root.genvid.proto.NodeType[e.type]:e.type),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),null!=e.streamId&&e.hasOwnProperty("streamId")&&(r.streamId=e.streamId),e.children&&e.children.length){r.children=[];for(var n=0;n<e.children.length;++n)r.children[n]=$root.genvid.proto.CompositionNode.toObject(e.children[n],t)}return null!=e.source&&e.hasOwnProperty("source")&&(r.source=$root.genvid.proto.CompositionNode.toObject(e.source,t)),null!=e.affineMatrix&&e.hasOwnProperty("affineMatrix")&&(r.affineMatrix=$root.genvid.proto.Mat3.toObject(e.affineMatrix,t)),null!=e.opacity&&e.hasOwnProperty("opacity")&&(r.opacity=t.json&&!isFinite(e.opacity)?String(e.opacity):e.opacity),null!=e.sourceId&&e.hasOwnProperty("sourceId")&&(r.sourceId=e.sourceId),null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&(r.videoSourceCompositionType=t.enums===String?$root.genvid.proto.CompositionType[e.videoSourceCompositionType]:e.videoSourceCompositionType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.NodeType=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="RTMSP"]=1,t[e[2]="COMPOSITE"]=2,t[e[3]="AFFINE"]=3,t[e[4]="STILLIMAGE"]=4,t}(),r.Reason=function(){var e={},t=Object.create(e);return t[e[0]="VIDEOFRAMEENCODED"]=0,t[e[1]="IDLE"]=1,t[e[2]="UNDEFINEDEREASON"]=2,t}(),r.CompositionType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINEDLAYOUT"]=0,t[e[1]="PIPVIDEOLAYOUT"]=1,t[e[2]="CHROMAKEYVIDEOLAYOUT"]=2,t[e[3]="NOTSET"]=3,t}(),r),n}();var genvidproto=$root;const version="1.29.0";var EnumCompositionType=["Undefined","PipVideoLayout","ChromaKeyVideoLayout","NotSet"],EnumNodeType=["DEFAULT","RTMSP","COMPOSITE","AFFINE","STILLIMAGE"];function protoToMatrix(e){return e?[e.c0r0||0,e.c0r1||0,e.c0r2||0,e.c1r0||0,e.c1r1||0,e.c1r2||0,e.c2r0||0,e.c2r1||0,e.c2r2||0]:[0,0,0,0,0,0,0,0,0]}function protoToCompositiondata(e){var t,r;switch(e.type){case genvidproto.genvid.proto.NodeType.AFFINE:return e.source?protoToCompositiondata(e.source).map((function(t){return t.affineMatrix=mat3ToArray(prodmat3(mat3FromArray(protoToMatrix(e.affineMatrix)),mat3FromArray(t.affineMatrix))),t.opacity=t.opacity*(e.opacity||0),t})):[];case genvidproto.genvid.proto.NodeType.COMPOSITE:var n=[];try{for(var i=__values(e.children||[]),o=i.next();!o.done;o=i.next()){var s=o.value;n.push.apply(n,__spread(protoToCompositiondata(s).map((function(t){return t.type=EnumCompositionType[e.videoSourceCompositionType||0],t}))))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n;case genvidproto.genvid.proto.NodeType.RTMSP:return[{affineMatrix:[1,0,0,0,1,0,0,0,1],opacity:1,sessionId:""+(e.sessionId||0),streamId:""+(e.streamId||0),type:EnumCompositionType[e.videoSourceCompositionType||0]}];default:return error("Composition data translation not implemented for node of type",EnumNodeType[e.type||0]),[]}}function mat3FromArray(e){if(9!==e.length)throw new Error("Cannot convert this object into a matrix, wrong size: "+e.length);var t=__read(e,9),r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],c=t[6],u=t[7],l=t[8];return mat3(vec3(r,o,c),vec3(n,s,u),vec3(i,a,l))}function mat3ToArray(e){return[e.rows[0].x,e.rows[1].x,e.rows[2].x,e.rows[0].y,e.rows[1].y,e.rows[2].y,e.rows[0].z,e.rows[1].z,e.rows[2].z]}function prodmat3(e,t){var r=transposemat3(t);return mat3(mulmat3(r,e.rows[0]),mulmat3(r,e.rows[1]),mulmat3(r,e.rows[2]))}function mulmat3(e,t){return vec3(dot3D(e.rows[0],t),dot3D(e.rows[1],t),dot3D(e.rows[2],t))}function vec3(e,t,r){return{x:e,y:t,z:r}}function dot3D(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function mat3(e,t,r){return{rows:[e,t,r]}}function transposemat3(e){var t=e.rows[0],r=e.rows[1],n=e.rows[2];return mat3(vec3(t.x,r.x,n.x),vec3(t.y,r.y,n.y),vec3(t.z,r.z,n.z))}function newRpcWrapper(){return new RpcWrapper}var RpcWrapper=function(){function e(){this.idCounter=1,this.requestMap={},this.msgMap={},this.LeafEnvelope=genvidproto.genvid.proto.LeafEnvelope}return e.prototype.init=function(e,t){var r=this;this.ws=e,this.ws.onmessage=function(e){t(e),r.wsOnMessage(e)}},e.prototype.registerMessage=function(e,t){this.msgMap[e]=t},e.prototype.wsOnMessage=function(e){try{this.LeafEnvelope.create();var t=this.LeafEnvelope.decode(new Uint8Array(e.data));if(t.method)this.onMethodReceived(t);else{if(!t.result&&!t.error)throw Error("Unknown message");this.onReplyReceived(t)}}catch(e){throw error(e),e}},e.prototype.onReplyReceived=function(e){var t=this.requestMap[e.id];t?(e.result?t.executor(e.result):t.reject(e.error),delete this.requestMap[e.id]):error("Callback not found")},e.prototype.onMethodReceived=function(e){var t=this.msgMap[e.method];if(!t)throw e.id&&this.sendError(e.id,-32601,"Method not found"),Error("Method not found");try{var r=t(e.params);if(e.id){var n={id:e.id,result:r},i=this.LeafEnvelope.create(n),o=this.LeafEnvelope.encode(i).finish();this.ws&&this.ws.send(o)}}catch(t){throw e.id&&this.sendError(e.id,-32603,"Internal error"),t}},e.prototype.sendError=function(e,t,r){var n=this.LeafEnvelope.create({id:e,error:{code:t,message:r}}),i=this.LeafEnvelope.encode(n).finish();this.ws&&this.ws.send(i)},e.prototype.sendMsg=function(e,t){var r=this.LeafEnvelope.create({method:e,params:t}),n=this.LeafEnvelope.encode(r).finish();this.ws&&this.ws.send(n)},e.prototype.sendRequest=function(e,t){var r=this;return new Promise((function(n,i){var o=r.idCounter++,s=r.LeafEnvelope.create({method:e,params:t,id:o}),a={env:s,executor:n,reject:i};r.requestMap[o]=a;var c=r.LeafEnvelope.encode(s).finish();r.ws&&r.ws.send(c)}))},e}();function newTimeSmoother(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=new Date),void 0===r&&(r=1/0),new TimeSmoother(e,t,r)}var TimeSmoother=function(){function e(e,t,r){void 0===e&&(e=0),void 0===t&&(t=new Date),void 0===r&&(r=1/0),this.lastObservedTime=e,this.lastObservedTimeClient=t||new Date,this.maxEstimationDuration=r}return e.prototype.set=function(e,t){void 0===t&&(t=new Date),e!==this.lastObservedTime&&(this.lastObservedTime=e,this.lastObservedTimeClient=t||new Date)},e.prototype.get=function(e){void 0===e&&(e=new Date);var t=(e=e||new Date).getTime()-this.lastObservedTimeClient.getTime();return t=Math.min(t,this.maxEstimationDuration),this.lastObservedTime+t},e.prototype.set_get=function(e,t){return void 0===t&&(t=new Date),this.set(e,t),this.get(t)},e.prototype.set_max_estimation_duration=function(e){this.maxEstimationDuration=e},e}(),PlayerEvents={PLAYING:"playing",PAUSE:"pause"};function newFakePlayer(e,t,r,n){return new FakePlayer(e,t,r,n)}var FakePlayer=function(){function e(e,t,r,n){this.paused=!1,this.muted=!1,this.volume=1,this.playerDiv=getConfig().window.document.getElementById(e),this.playerDiv.setAttribute("style","width: 100%; height: 100%;"),this.channel=t,this.options=n,r&&r(this.playerDiv)}return e.prototype.getSyncTime=function(e){return Date.now()/1e3},e.prototype.getCurrentTime=function(){return Date.now()/1e3},e.prototype.play=function(){this.paused=!1,this.eventPlaying&&this.eventPlaying(PlayerEvents.PLAYING)},e.prototype.pause=function(){this.paused=!0,this.eventPlaying&&this.eventPause&&this.eventPause(PlayerEvents.PAUSE)},e.prototype.isPaused=function(){return this.paused},e.prototype.getMuted=function(){return this.muted},e.prototype.setMuted=function(e){this.muted=e},e.prototype.getVolume=function(){return this.volume},e.prototype.setVolume=function(e){this.volume=e<0?0:e>1?1:e},e.prototype.addEventListener=function(e,t){switch(e){case PlayerEvents.PLAYING:this.eventPlaying=t;break;case PlayerEvents.PAUSE:this.eventPause=t;break;default:throw Error("Invalid event:"+e)}},e}(),HttpClient=function(){function e(){}return e.prototype.get=function(e,t){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&200===r.status&&t(r.responseText)},r.open("GET",e,!0),r.send()},e}();function newTwitchPlayer(e,t,r,n,i){return new TwitchPlayer(e,t,r,n,i)}function getAverageNtpTransportTimeSinceLastCall(e){if(e instanceof TwitchPlayer){var t=e.totalNtpTransportTimeMS/e.numNtpRequests;return e.totalNtpTransportTimeMS=0,e.numNtpRequests=0,t}return-1}var TwitchPlayer=function(){function e(e,t,r,n,i){var o=this;this.playerReady=!1,this.twitchOptions={},this.clientSendTimeMS=0,this.ntpTimeOffsetMS=0,this.numNtpRequests=0,this.totalNtpTransportTimeMS=0,this.paused=!1,this.muted=!1,this.volume=100,this.ntpPollingIntervalMS=1e4,this.ntpPollingHandle=-1,this.lastCurrentTimeMS=-1,this.firstPlaybackStats=0,this.twitchOptions=n||{},this.twitchOptions.width=n.width||"100%",this.twitchOptions.height=n.height||"100%",this.twitchOptions.channel=n.channel||t,this.twitchOptions.parent=n.parent||[],this.ntpURL=i,this.twitchReady=r,this.twitchDiv=e;var s=document.createElement("script");s.src="https://player.twitch.tv/js/embed/v1.js";var a=document.getElementsByTagName("script")[0];if(!a||!a.parentNode)throw Error("No script tag insertable");a.parentNode.insertBefore(s,a),s.onload=this.onTwitchApiReady.bind(this),this.httpRequestNtpTime(),this.ntpPollingHandle=setInterval((function(){o.httpRequestNtpTime()}),this.ntpPollingIntervalMS)}return e.prototype.close=function(){-1!==this.ntpPollingHandle&&clearInterval(this.ntpPollingHandle)},e.prototype.onTwitchApiReady=function(){this.player=new Twitch.Player(this.twitchDiv,this.twitchOptions),this.player.addEventListener(Twitch.Player.READY,this.onTwitchReady.bind(this))},e.prototype.onTwitchReady=function(){if(this.twitchReady&&!this.playerReady&&this.player){var e=getConfig().window.document.getElementById(this.twitchDiv);this.twitchReady(e),this.paused?this.pause():this.play(),this.setMuted(this.muted),this.setVolume(this.volume),this.playerReady=!0}},e.prototype.getCurrentTime=function(){var e=this.getPlaybackStats();return this.playerReady?this.player&&this.player.isPaused()||(this.ntpTimeOffsetMS&&e&&e.hlsLatencyBroadcaster?this.lastCurrentTimeMS=Date.now()-1e3*e.hlsLatencyBroadcaster+this.ntpTimeOffsetMS:this.lastCurrentTimeMS=-1):this.lastCurrentTimeMS=-1,this.lastCurrentTimeMS},e.prototype.httpRequestNtpTime=function(){var e=this,t=new HttpClient;this.clientSendTimeMS=(new Date).getTime(),t.get(this.ntpURL,(function(t){return e.ntpResponse(t)}))},e.prototype.ntpResponse=function(e){var t=(new Date).getTime(),r=(t-this.clientSendTimeMS)/2,n=JSON.parse(e),i=Date.parse(n.time);this.ntpTimeOffsetMS=i+r-t,this.totalNtpTransportTimeMS+=r,this.numNtpRequests++},e.prototype.play=function(){this.player&&(this.player.play(),this.paused=this.player.isPaused())},e.prototype.pause=function(){this.player&&(this.player.pause(),this.paused=this.player.isPaused())},e.prototype.isPaused=function(){return this.player&&(this.paused=this.player.isPaused()),this.paused},e.prototype.getMuted=function(){return this.player&&(this.muted=this.player.getMuted()),this.muted},e.prototype.setMuted=function(e){this.muted=!!e,this.player&&this.player.setMuted(this.muted)},e.prototype.getVolume=function(){return this.volume},e.prototype.setVolume=function(e){this.volume=Math.min(Math.max(0,e),100),this.player&&this.player.setVolume(this.volume/100)},e.prototype.setSteamInfo=function(e){e.ntpuri&&(this.ntpURL=e.ntpuri)},e.prototype.getPlaybackStats=function(){if(this.playerReady&&this.player){this.firstPlaybackStats=this.firstPlaybackStats||Date.now();var e=this.player.getPlaybackStats();return 0===e.hlsLatencyBroadcaster&&Date.now()-this.firstPlaybackStats>5e3&&(e.hlsLatencyBroadcaster=1e-4),e}},e.prototype.addEventListener=function(e,t){var r="";switch(e){case PlayerEvents.PLAYING:r=Twitch.Player.PLAY;break;case PlayerEvents.PAUSE:r=Twitch.Player.PAUSE;break;default:throw Error("Invalid event:"+e)}this.player&&this.player.addEventListener(r,(function(){t(e)}))},e.prototype.getSyncTime=function(e){return e.sendingTime},e}();function newTwitchExtPlayer(e,t,r,n,i){return new TwitchExtPlayer(e,t,r,n,i)}var EventInfo=function(e,t){this.name=e,this.handler=t},TwitchExtPlayer=function(){function e(e,t,r,n,i){var o=this;this.playerReady=!1,this.init={},this.options={},this.clientSendTimeMS=0,this.ntpTimeOffsetMS=0,this.paused=!0,this.hlsLatencyBroadcasterS=-1,this.eventInfoArray=[],this.ntpPollingIntervalMS=1e4,this.ntpPollingHandle=-1,this.lastCurrentTimeMS=-1,this.options=n||{},this.options.channel=n.channel||t,this.ntpURL=i,this.onReady=r,getConfig().window.Twitch.ext.onContext(this.onTwitchExtContext.bind(this)),this.httpRequestNtpTime(),this.ntpPollingHandle=setInterval((function(){o.httpRequestNtpTime()}),this.ntpPollingIntervalMS)}return e.prototype.close=function(){-1!==this.ntpPollingHandle&&clearInterval(this.ntpPollingHandle)},e.prototype.getCurrentTime=function(){return this.playerReady?this.player&&this.player.isPaused()||(this.ntpTimeOffsetMS&&this.hlsLatencyBroadcasterS>0?this.lastCurrentTimeMS=Date.now()-1e3*this.hlsLatencyBroadcasterS+this.ntpTimeOffsetMS:this.lastCurrentTimeMS=-1):this.lastCurrentTimeMS=-1,this.lastCurrentTimeMS},e.prototype.play=function(){throw Error("play() is not implemented for TwitchExtPlayer!")},e.prototype.pause=function(){throw Error("pause() is not implemented for TwitchExtPlayer!")},e.prototype.isPaused=function(){return this.paused},e.prototype.getMuted=function(){throw Error("getMuted() is not implemented for TwitchExtPlayer!")},e.prototype.setMuted=function(e){throw Error("setMuted() is not implemented for TwitchExtPlayer!")},e.prototype.getVolume=function(){throw Error("getVolume() is not implemented for TwitchExtPlayer!")},e.prototype.setVolume=function(e){throw Error("setVolume() is not implemented for TwitchExtPlayer!")},e.prototype.addEventListener=function(e,t){this.eventInfoArray.push(new EventInfo(e,t))},e.prototype.getSyncTime=function(e){return e.sendingTime},e.prototype.setSteamInfo=function(e){e.ntpuri&&(this.ntpURL=e.ntpuri)},e.prototype.onTwitchExtContext=function(e,t){var r,n;if(this.playerReady)try{for(var i=__values(t),o=i.next();!o.done;o=i.next())switch(o.value){case"isPaused":this.paused!==e.isPaused&&(this.paused=e.isPaused,this.paused?this.fireEvent(PlayerEvents.PAUSE):this.fireEvent(PlayerEvents.PLAYING));break;case"hlsLatencyBroadcaster":this.hlsLatencyBroadcasterS=e.hlsLatencyBroadcaster}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else this.paused=e.isPaused,this.hlsLatencyBroadcasterS=e.hlsLatencyBroadcaster,this.playerReady||(this.init={},this.playerReady=!0,this.onReady());var s={context:e,contextFields:t};this.fireEvent("twitchextoncontext",s)},e.prototype.httpRequestNtpTime=function(){var e=this,t=new HttpClient;this.clientSendTimeMS=Date.now(),t.get(this.ntpURL,(function(t){return e.ntpResponse(t)}))},e.prototype.ntpResponse=function(e){var t=Date.now(),r=(t-this.clientSendTimeMS)/2,n=JSON.parse(e),i=Date.parse(n.time);this.ntpTimeOffsetMS=i+r-t},e.prototype.fireEvent=function(e,t){var r,n;void 0===t&&(t={});try{for(var i=__values(this.eventInfoArray),o=i.next();!o.done;o=i.next()){var s=o.value;s.name===e&&s.handler(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e}();function newFreeWheel(e){return new FreeWheel(e)}var FreeWheel=function(){function e(e){this.maxError=0,this.speed=0,this.lastPos=0,this.lastTime=0,this.maxError=e}return e.prototype.stop=function(){this.speed=0},e.prototype.isStopped=function(){return 0===this.speed},e.prototype.touch=function(e,t,r){var n=this.getPosition(e);return Math.abs(n-t)>this.maxError?(this.lastPos=t,this.lastTime=e,this.speed=r,t):r!==this.speed?(this.lastPos=n,this.lastTime=e,this.speed=r,n):n},e.prototype.getPosition=function(e){return this.lastPos+this.speed*(e-this.lastTime)},e}();function replaceTargetWith(e,t){var r=getConfig().window.document.getElementById(e);if(!r||!r.parentNode)throw Error("Impossible to find element: "+e);var n,i,o,s=r;for((i=document.createElement("div")).innerHTML=t,n=i.childNodes.length;n--;)r.parentNode.insertBefore(o=i.childNodes[n],s),s=o;r.parentNode.removeChild(r)}function newYouTubePlayer(e,t,r,n){return new YouTubePlayer(e,t,r,n)}var YouTubePlayer=function(){function e(e,t,r,n){if(this.playerPreviouslyInitialized=!1,this.init={},this.apiReady=!1,this.playerReady=!1,this.options={controls:0,disablekb:1,enablejsapi:1,autoplay:1,fs:0,playsinline:1,rel:0},this.videoTimeSmoother=newTimeSmoother(),this.maxVideoEstimationDurationMS=3e3,this.freeWheel=newFreeWheel(.045),this.paused=!1,this.muted=!1,this.volume=100,this.playerPreviouslyInitialized=!!getConfig().window.onYouTubeIframeAPIReady,this.videoDiv=e,this.channel=t,this.onReady=r,n)for(var i in n)this.options[i]=n[i];this.playerPreviouslyInitialized?(this.replaceVideoPlayer(),this.onYouTubeIframeAPIReady()):(this.loadYouTubeIFrameAPI(),this.replaceVideoPlayer()),this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS)}return e.prototype.loadYouTubeIFrameAPI=function(){getConfig().window.onYouTubeIframeAPIReady=this.onYouTubeIframeAPIReady.bind(this);var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];if(!t||!t.parentNode)throw Error("Theoretically could not be reached");t.parentNode.insertBefore(e,t)},e.prototype.onYouTubeIframeAPIReady=function(){this.apiReady=!0,this.bindVideoPlayer()},e.prototype.onPlayerReady=function(e){if(this.playerReady=!0,this.paused?this.pause():this.play(),this.setMuted(this.muted),this.setVolume(this.volume),e.target.playVideo(),this.onReady){var t=getConfig().window.document.getElementById(this.videoDiv);this.onReady(t)}},e.prototype.replaceVideoPlayer=function(){var e=["channel="+this.channel];for(var t in this.options)e.push(t+"="+this.options[t]);var r='<iframe id="'+this.videoDiv+'" src="https://www.youtube.com/embed/'+this.channel+"?"+e.join("&")+'" frameborder="0" allow="autoplay \'src\'"></iframe>';replaceTargetWith(this.videoDiv,r)},e.prototype.bindVideoPlayer=function(){var e={width:"100%",height:"100%",videoId:this.channel,playerVars:this.options,events:{onReady:this.onPlayerReady.bind(this)}};this.player=new YT.Player(this.videoDiv,e)},e.prototype.getCurrentTime=function(){if(this.playerReady){var e=this.isPaused();e?this.videoTimeSmoother.set_max_estimation_duration(0):this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS);var t=new Date,r=1e3*this.player.getMediaReferenceTime();return r<=0?-1:(r=this.videoTimeSmoother.set_get(r,t),e||(r=this.freeWheel.touch(Date.now(),r,.001)),r)}return-1},e.prototype.play=function(){this.player&&this.player.playVideo()},e.prototype.pause=function(){this.player&&this.player.pauseVideo(),this.freeWheel.stop()},e.prototype.isPaused=function(){if(this.player){var e=this.player.getPlayerState();this.paused=e===YT.PlayerState.PAUSED}return this.paused},e.prototype.getMuted=function(){return this.player&&(this.muted=this.player.isMuted()),!!this.muted},e.prototype.setMuted=function(e){this.muted=!!e,this.player&&(this.muted?this.player.mute():this.player.unMute())},e.prototype.getVolume=function(){return this.volume},e.prototype.setVolume=function(e){this.volume=Math.min(Math.max(0,e),100),this.player&&this.player.setVolume(this.volume)},e.prototype.addEventListener=function(e,t){var r=0;switch(e){case PlayerEvents.PLAYING:r=YT.PlayerState.PLAYING;break;case PlayerEvents.PAUSE:r=YT.PlayerState.PAUSED;break;default:throw new Error("Invalid event:"+e)}this.player&&this.player.addEventListener("onStateChange",(function(n){var i=n.data;r===i&&t(e)}))},e.prototype.reloadVideoPlayer=function(e){this.player?(log("Reloading video player with new VideoID"),this.player.loadVideoById(e)):error("videoPlayer need to be instantiated before being reloaded")},e.prototype.getSyncTime=function(e){return(e.startIngestTime||0)+(e.pts||0)},e}(),FBPlayerEvents;function newFacebookPlayer(e,t,r,n){return new FacebookPlayer(e,t,r,n)}!function(e){e.StartedPlaying="startedPlaying",e.Paused="paused",e.FinishedPlaying="finishedPlaying",e.StartedBuffering="startedBuffering",e.FinishedBuffering="finishedBuffering",e.Error="error"}(FBPlayerEvents||(FBPlayerEvents={}));var EventInfo$1=function(e,t){this.name=e,this.handler=t},FacebookPlayer=function(){function e(e,t,r,n){var i=this;if(this.playerPreviouslyInitialized=!1,this.init={},this.apiLoaded=!1,this.playerReady=!1,this.settings={},this.options={controls:"false",allowfullscreen:"false",autoplay:"false",lazy:"false",width:"auto",showText:"false",showCaptions:"false",apiVersion:"undefined",appId:"undefined",debug:!1,fakeSync:!1,fakeSyncDelayMS:0},this.videoTimeSmoother=newTimeSmoother(),this.maxVideoEstimationDurationMS=3e3,this.freeWheel=newFreeWheel(.045),this.eventInfoArray=[],this.FBEventHandlers={},this.paused=!1,this.muted=!1,this.volume=100,this.currentPosition=0,this.duration=0,this.onPlayerReady=function(e){if("video"===e.type&&e.id===i.fbDivId){if(i.playerReady=!0,i.player=e.instance,i.player.mute(),i.paused?i.pause():i.play(),i.setMuted(i.muted),i.setVolume(i.volume),i.onReady){var t=getConfig().window.document.getElementById(i.videoDivId);i.onReady(t)}log("xfbml.ready for video",e.id)}},this.playerPreviouslyInitialized=!!getConfig().window.fbAsyncInit,this.videoDivId=e,this.channel=t,this.onReady=r,this.fbDivId="",n)for(var o in n)this.options[o]=n[o];this.options.debug?this.sdkSrc="https://connect.facebook.net/en_US/sdk/debug.js":this.sdkSrc="https://connect.facebook.net/en_US/sdk.js",this.playerPreviouslyInitialized?this.initFacebookApi():this.loadFacebookAPI(),this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS)}return e.prototype.loadFacebookAPI=function(){var e=getConfig().window;if(null!==e.fbAsyncInit){e.fbAsyncInit=this.onFacebookApiLoaded.bind(this);var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.defer=!0,t.crossOrigin="anonymous",t.src=this.sdkSrc;var r=document.body.firstChild;if(!r||!r.parentNode)throw Error("Theoretically could not be reached");r.parentNode.insertBefore(t,r)}},e.prototype.onFacebookApiLoaded=function(){this.apiLoaded=!0,this.initFacebookApi()},e.prototype.initFacebookApi=function(){if(null!=typeof FB){var e={appId:this.options.appId,xfbml:!0,version:this.options.apiVersion};FB.init(e),FB.Event.subscribe("xfbml.ready",this.onPlayerReady),this.onFacebookApiInit()}else error("FB object not found, we can't create a player.")},e.prototype.onFacebookApiInit=function(){var e=this.getFacebookPermalinkUrl();e&&this.createFacebookEmbedVideoPlayer(e)},e.prototype.subscribeToFBEvent=function(e){var t=this,r=this.player.subscribe(e,(function(r){t.fireEvent(e,r)}));this.FBEventHandlers[e]=r},e.prototype.fireEvent=function(e,t){var r,n;void 0===t&&(t={});try{for(var i=__values(this.eventInfoArray),o=i.next();!o.done;o=i.next()){var s=o.value;s.name===e&&s.handler(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.createFacebookEmbedVideoPlayer=function(e,t){void 0===t&&(t=!1),this.playerReady=!1;var r=getConfig().window.document.getElementById(this.videoDivId);if(this.fbDivId=Date.now().toString(),console.log("fb div on create",this.fbDivId),!r)throw Error("No div id defined");if(r.querySelectorAll("*").forEach((function(e){return e.remove()})),!e||e.length<=0)warn("Channel is empty no video player will be instantiated.");else{var n=document.createElement("div");n.id=this.fbDivId,n.classList.add("fb-video"),n.dataset.href=e,n.dataset.controls=this.options.controls,n.dataset.allowfullscreen=this.options.allowfullscreen,n.dataset.autoplay=this.options.autoplay,n.dataset.lazy=this.options.lazy,n.dataset.width=this.options.width,n.dataset.showText=this.options.showText,n.dataset.showCaptions=this.options.showCaptions,r.appendChild(n),t&&setTimeout((function(){FB.XFBML.parse()}),15e3)}},e.prototype.getFacebookPermalinkUrl=function(){return this.channel},e.prototype.getCurrentTime=function(){if(this.playerReady){var e=this.isPaused();e?this.videoTimeSmoother.set_max_estimation_duration(0):this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS);var t=new Date,r=this.options.fakeSync?new Date(Date.now()).getTime()-this.options.fakeSyncDelayMS:1e3*this.player.getCurrentPosition();return r<=0?-1:(r=this.videoTimeSmoother.set_get(r,t),e||(r=this.freeWheel.touch(Date.now(),r,.001)),r)}return-1},e.prototype.play=function(){this.player&&this.player.play(),this.paused=!1},e.prototype.pause=function(){this.player&&this.player.pause(),this.paused=!0},e.prototype.isPaused=function(){return this.paused},e.prototype.getMuted=function(){return this.player&&(this.muted=this.player.isMuted()),!!this.muted},e.prototype.setMuted=function(e){this.muted=!!e,this.player&&(this.muted?this.player.mute():this.player.unmute())},e.prototype.getVolume=function(){return this.player&&(this.volume=100*this.player.getVolume()),this.volume},e.prototype.setVolume=function(e){this.volume=Math.min(Math.max(0,e),100),this.player&&this.player.setVolume(this.volume/100)},e.prototype.getCurrentPosition=function(){return this.player&&(this.currentPosition=this.player.getCurrentPosition()),this.currentPosition},e.prototype.getDuration=function(){return this.player&&(this.duration=this.player.getDuration()),this.duration},e.prototype.addEventListener=function(e,t){switch(e){case PlayerEvents.PLAYING:this.checkAndAddListener(FBPlayerEvents.StartedPlaying,t);break;case PlayerEvents.PAUSE:this.checkAndAddListener(FBPlayerEvents.Paused,t);break;case FBPlayerEvents.FinishedPlaying:case FBPlayerEvents.StartedBuffering:case FBPlayerEvents.FinishedBuffering:case FBPlayerEvents.Error:this.checkAndAddListener(e,t);break;default:console.error("Unsupported event ! event:",e)}},e.prototype.checkAndAddListener=function(e,t){this.FBEventHandlers[e]||this.subscribeToFBEvent(e),this.eventInfoArray.push(new EventInfo$1(e,t))},e.prototype.removeEventListener=function(e){this.FBEventHandlers&&this.FBEventHandlers[e]&&(this.FBEventHandlers[e].release(e),delete this.FBEventHandlers[e],this.eventInfoArray=this.eventInfoArray.filter((function(t){return t.name!==e})))},e.prototype.close=function(){var e=getConfig().window.document.getElementById(this.videoDivId);e&&e.querySelectorAll("*").forEach((function(e){return e.remove()})),FB.Event.unsubscribe("xfbml.ready",this.onPlayerReady),this.playerReady=!1},e.prototype.getSyncTime=function(e){return e.sendingTime,e.pts,this.options.fakeSync?e.sendingTime:e.pts},e}(),kPauseSkipIntervalMS=1e4,kResumeLatencyS=0;function newStandalonePlayer(e,t,r,n){return new StandalonePlayer(e,t,r,n)}var FetchIncrementalLoader=function(){function e(){}return e.prototype.get=function(e,t,r,n){return __awaiter(this,void 0,void 0,(function(){var i,o,s,a,c,u,l,d,p,h,m,f;return __generator(this,(function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),[4,fetch(e)];case 1:return s=g.sent(),[3,3];case 2:return a=g.sent(),n(a),[2];case 3:if(!(c=s.headers.get("Content-Type")))throw Error("No codec given in Content-Type header");if(u=0,(l=s.headers.get("x-genvid-start-pts"))&&(u=1e3*parseFloat(l)),!t(c,u))return[3,19];g.label=4;case 4:if(g.trys.push([4,17,,18]),!s.body)throw Error("Cannot read stream, the response does not contain a body");g.label=5;case 5:g.trys.push([5,10,11,16]),d=__asyncValues(this.streamToIterator(s.body)),g.label=6;case 6:return[4,d.next()];case 7:if((p=g.sent()).done)return[3,9];h=p.value,r(h),g.label=8;case 8:return[3,6];case 9:return[3,16];case 10:return m=g.sent(),i={error:m},[3,16];case 11:return g.trys.push([11,,14,15]),p&&!p.done&&(o=d.return)?[4,o.call(d)]:[3,13];case 12:g.sent(),g.label=13;case 13:return[3,15];case 14:if(i)throw i.error;return[7];case 15:return[7];case 16:return[3,18];case 17:return f=g.sent(),n(f),[2];case 18:return[3,20];case 19:setTimeout((function(){window.location.reload()}),2e3),g.label=20;case 20:return[2]}}))}))},e.prototype.streamToIterator=function(e){return __asyncGenerator(this,arguments,(function(){var t,r,n,i;return __generator(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,__await(t.read())];case 3:return r=o.sent(),n=r.done,i=r.value,n?[4,__await(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,__await(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))},e}(),StandalonePlayer=function(){function e(e,t,r,n){this.streamingMetaUrl="",this.playerReady=!1,this.timeOffsetMS=0,this.pendingSegmentArray=[],this.freeWheel=newFreeWheel(45),this.streamingMetaUrl=t.replace(".mp4","-meta.json"),this.videoPlayerOptions=n,this.onPlayerReady=r,this.insertVideoPlayer(e,t),this.timeSinceLastSkip=Date.now()}return e.prototype.getSyncTime=function(e){return e.pts||0},e.prototype.getDeviationFromLatestFrame=function(){return this.videoElement&&this.videoElement.seekable.length>0?1e3*(this.videoElement.seekable.end(0)-this.videoElement.currentTime):-1},e.prototype.getPlaybackRate=function(){return this.videoElement?this.videoElement.playbackRate:1},e.prototype.getVideoEmulatedTime=function(e){var t=this.videoElement;return"frame"===e?t.webkitDecodedFrameCount/30:"bit"===e&&this.streamingMeta?t.webkitVideoDecodedByteCount/(8*this.streamingMeta.video["bit-rate"]):void 0},e.prototype.httpRequestStreamingMeta=function(){var e=this;(new HttpClient).get(this.streamingMetaUrl,(function(t){e.streamingMeta=JSON.parse(t),e.timeOffsetMS=1e3*e.streamingMeta["last-start-pts"]}))},e.prototype.initMediaSource=function(e){if(this.MediaSource=window.MediaSource||window.WebKitMediaSource,!this.MediaSource)return warn("MediaSource is not supported"),!1;var t=new this.MediaSource;return this.mediaSource=t,t.addEventListener("sourceopen",(function(t){return e()}),!1),t.addEventListener("webkitsourceopen",(function(t){return e()}),!1),t.addEventListener("sourceended",(function(e){return log("sourceended:"+t.readyState)})),t.addEventListener("sourceclose",(function(e){return log("sourceclose:"+t.readyState)})),t.addEventListener("error",(function(e){return log("media source error:"+t.readyState)})),!0},e.prototype.initSourceBuffer=function(e){var t=this;if(this.sourceBuffer&&this.mediaSource)return info("No need to reinit the source buffer"),!0;if(log(e,"isTypeSupported:",this.MediaSource.isTypeSupported(e)),!this.mediaSource)throw Error("Impossible to init source buffer: mediaSource not initialized");return"open"===this.mediaSource.readyState&&this.MediaSource.isTypeSupported(e)?(this.sourceBuffer=this.mediaSource.addSourceBuffer(e),this.sourceBuffer.mode="sequence",this.sourceBuffer.addEventListener("updateend",(function(e){t.pendingSegmentArray.length>0&&t.sourceBuffer&&!t.sourceBuffer.updating&&t.sourceBuffer.appendBuffer(t.pendingSegmentArray.shift())})),this.sourceBuffer.addEventListener("error",(function(e){return log(t.mediaSource&&t.mediaSource.readyState,e)})),this.sourceBuffer.addEventListener("abort",(function(e){return log(t.mediaSource&&t.mediaSource.readyState)})),!0):(warn("Could not initialize the source buffer: media source not open or type not supported."),!1)},e.prototype.startLoader=function(e){var t=this;(new FetchIncrementalLoader).get(e,(function(e,r){var n=t.initSourceBuffer(e);return r&&(t.timeOffsetMS=r),n}),(function(e){e&&t.sourceBuffer&&(t.sourceBuffer.updating||t.pendingSegmentArray.length>0?t.pendingSegmentArray.push(e):(t.isPaused()&&t.videoElement&&t.sourceBuffer.buffered.length>0&&t.sourceBuffer.buffered.end(0)-kResumeLatencyS>t.videoElement.currentTime&&t.timeSinceLastSkip+kPauseSkipIntervalMS<Date.now()&&(t.timeSinceLastSkip=Date.now(),t.videoElement.currentTime=t.sourceBuffer.buffered.end(0)-kResumeLatencyS),t.sourceBuffer.appendBuffer(e)))}),(function(r){error(r),setTimeout((function(){return t.startLoader(e)}),2e3)}))},e.prototype.insertVideoPlayer=function(e,t){var r=this,n=document.getElementById(e);if(!n)throw Error("Impossible to insert video player, could not find videoDivId: "+e);if(this.videoContainer=n,!this.videoContainer)throw Error("Element id not found: "+e);this.videoElement=document.createElement("video"),this.videoContainer.appendChild(this.videoElement),this.videoPlayerOptions.width&&(this.videoElement.width=this.videoPlayerOptions.width),this.videoPlayerOptions.height&&(this.videoElement.height=this.videoPlayerOptions.height),this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.autoplay=!0;var i=document.createElement("div");this.videoContainer.appendChild(i),i.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFEmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxOC0wNS0yMlQwOToxMzoyOC0wNDowMCIgeG1wOk1vZGlmeURhdGU9IjIwMTgtMTAtMjRUMTI6NTM6NDItMDQ6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTgtMTAtMjRUMTI6NTM6NDItMDQ6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6YmYwNWMyZjQtYTZhMC0xNTRlLWExZGYtZDYyMWViOTQzY2JiIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOmJmMDVjMmY0LWE2YTAtMTU0ZS1hMWRmLWQ2MjFlYjk0M2NiYiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmJmMDVjMmY0LWE2YTAtMTU0ZS1hMWRmLWQ2MjFlYjk0M2NiYiI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YmYwNWMyZjQtYTZhMC0xNTRlLWExZGYtZDYyMWViOTQzY2JiIiBzdEV2dDp3aGVuPSIyMDE4LTA1LTIyVDA5OjEzOjI4LTA0OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pj8FVOsAAAVBSURBVHic7dhhjtNIFIVRZ8SmmCUN6xm2xLLMD8bQMOm047hc9eqeI/VfEgndTy91W9d1ATL91fsLAP0IAAQTAAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABDsU/NP+PL32vwzTnL7+u3W+zvAW+vadj7tA8Bh6z+ft/99YaIJPwFqWP/7g1MJQC1CwKkEoCYR4BQCUJdrgJcJQH1CwGECMA8h4GkCMB8RYDcBmJNrgF0EYG5CwEMCkEEIuEsAsogAvxGAPK4BfhKAXEKAACACyQSAZXENxBIA3hKCMALAPUIQQgB4RAQmJwB8xDUwMQFgLyGYkADwLCGYiABwlAhMQAB4hWugOAHgDEJQlABwJiEoRgBoQQSKEABacQ0UIAC0JgQDEwCuIgIDEgCu5BoYjADQgxAMQgDoSQg6EwBGIAKdCACjcA10IACMRgguJACMSgguIACMTgQaEgAqcA00IgBUIgQnEwAqEoGTCABVuQZOIABUJwQvEABmIQQHCACzEYEnCAAzcg3sJADMTAg+IAAkEIJ3CABJROAPAkAa18AbAkAqIVgEAKJDIADwQ2QEBAB+ibsGBAD+LyYEAgDvmz4CAgCPTX0NCADsM2UIBACeM1UIBACOmSICAgDHlb8GBABeVzYEAgDnKRcCAYDzlYmAAEAbJa4BAYC2hg6BAMA1hgyBAMC1hoqAAMD1hrkGBAD66R4CAYD+ukVAAGAMXa4BAYCxXBoCAYAxXRICAYBgn3p/AeCu2xUfIgAwlkuGvxEAGMOlw994A4D+uox/WVwA0FO34W8EAK7XffgbPwHgWsOMf1lcAHCVoYa/EQBoa8jhbwQA2hh6+BtvAHC+EuNfFhcAnKnM8DcCAK8rN/yNAMBxZYe/8QYAx5Qf/7K4AOBZUwx/IwCwz1TD3wgAPDbl8DfeAOB9U49/WVwAcM/0w98IAPwSM/yNnwDwQ9z4l8UFAJHD3wgAqaKHvxEA0hj+G94ASGL8f3ABkMDw3yEAzMzwPyAAzMjwd/IGwGyM/wkuAGZh+AcIANUZ/gsEgKoM/wTeAKjI+E/iAqASwz+ZAFCB4TfiJwCjM/6GXACMyvAvIACMxvAvJACMwvA78AbACIy/ExcAPRl+ZwJAD4Y/CAHgSoY/GG8AXMX4B+QCoDXDH5gA0IrhF+AnAC0YfxEuAM5k+MUIAGcw/KIEgFcYfnHeADjK+CfgAuBZhj8RAWAvw5+QAPARw5+YNwAeMf7JuQC4x/BDCABvGX4YAWBZDD+WNwCMP5gLIJfhIwCBDJ+f/ATIYvz8xgWQwfC5SwDmZvg8JABzMnx28QYwH+NnNxfAPAyfpwlAfYbPYQJQl+HzMm8ANRk/p3AB1GL4nEoAajB8mhCAgd2+fjP8cOu/bf/927qubT8BGJZHQAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABBMACCYAECw71XBksrygKczAAAAAElFTkSuQmCC')",i.style.backgroundRepeat="no-repeat",i.style.width="50%",i.style.height="50%",i.style.position="absolute",i.style.left="0%",i.style.right="0%",i.style.top="0%",i.style.bottom="0%",i.style.margin="auto",i.style.backgroundSize="contain",i.style.backgroundPosition="center";var o=this.initMediaSource((function(){r.startLoader(t)}));this.videoElement.src=o?window.URL.createObjectURL(this.mediaSource):t,this.videoElement.addEventListener("play",(function(){if(r.videoElement){if(i.hidden=!0,o){if(r.sourceBuffer&&r.sourceBuffer.buffered.length&&r.videoElement){var e=Math.max(r.sourceBuffer.buffered.start(0),r.sourceBuffer.buffered.end(0)-kResumeLatencyS);r.videoElement.currentTime=e}}else r.httpRequestStreamingMeta();r.firePlayerReady()}})),this.videoElement.addEventListener("pause",(function(){i.hidden=!1})),this.videoElement.addEventListener("loadstart",(function(){r.firePlayerReady()})),this.videoContainer.addEventListener("click",(function(){r.isPaused()?r.play():r.pause()})),this.videoElement.addEventListener("canplay",(function(){r.firePlayerReady()}))},e.prototype.firePlayerReady=function(){this.playerReady||(this.onPlayerReady(this.videoContainer),this.playerReady=!0)},e.prototype.getCurrentTime=function(){return this.videoElement?1e3*this.videoElement.currentTime+this.timeOffsetMS:-1},e.prototype.play=function(){this.videoElement&&this.videoElement.play()},e.prototype.pause=function(){this.freeWheel.stop(),this.videoElement&&this.videoElement.pause()},e.prototype.isPaused=function(){return!!this.videoElement&&this.videoElement.paused},e.prototype.getMuted=function(){return!!this.videoElement&&this.videoElement.muted},e.prototype.setMuted=function(e){this.videoElement&&(this.videoElement.muted=!!e)},e.prototype.getVolume=function(){return this.videoElement?100*this.videoElement.volume:0},e.prototype.setVolume=function(e){e=Math.min(Math.max(0,e),100),this.videoElement&&(this.videoElement.volume=e/100)},e.prototype.addEventListener=function(e,t){switch(e){case PlayerEvents.PLAYING:this.videoElement&&this.videoElement.addEventListener("play",(function(){return t(e)}));break;case PlayerEvents.PAUSE:this.videoElement&&this.videoElement.addEventListener("pause",(function(){return t(e)}));break;default:error("Unsupported event ! event:",e)}},e}(),ClientMetricManager=function(){function e(e,t){this.metricsTimerID=0,this.sendMetricsPeriod=5,this.clientMetricList=[],this.emptyTags=[],this.videoTimeMS=0,this.numLatencyUpdates=0,this.latencyAggregate=0,this.onDrawStartTime=0,this.onDrawDurationAggregate=0,this.onDrawDurationMin=1/0,this.onDrawDurationMax=0,this.onDrawPreviousTime=0,this.onDrawIntervalAggregate=0,this.onDrawIntervalMin=1/0,this.onDrawIntervalMax=0,this.numDrawCalls=0,this.decodeFramesLength=0,this.numFrameDecodes=0,this.decodeNotificationsLength=0,this.numNotifDecode=0,this.numFramesDecodeErrors=0,this.numNotificationDecodeErrors=0,this.lastStreamsReceivedTime=0,this.delayBetweenStreamsReceived=0,this.numOnStreamsReceived=0,this.bytesMetrics=[],this.framesMetrics=[],this.cacheTimeCapacityMetrics=[],this.cacheByteCapacityMetrics=[],this.numCachePushUpdates=0,this.syncErrorAggregate=0,this.syncErrorMin=1/0,this.syncErrorMax=0,this.syncErrorCounts=0,this.eventsSentSinceLastSentMetrics=0,this.rpc=e,this.mediaPlayer=t,this.registerConfigReception()}return e.prototype.startMetrics=function(){var e=this;0!==this.metricsTimerID&&this.stopMetrics(),this.metricsTimerID=setInterval((function(){e.sendMetrics()}),1e3*this.sendMetricsPeriod)},e.prototype.stopMetrics=function(){clearInterval(this.metricsTimerID),this.metricsTimerID=0},e.prototype.sendMetrics=function(){this.clientMetricList=[],this.AddPlaybackRateMetric(),this.AddVideoPlayerBufferMetrics(),this.AddCurrentVideoTimeMetric(),this.AddLatencyMetric(),this.AddOnDrawMetrics(),this.AddTwitchNTPTransportTime(),this.AddDataMetrics(),this.AddNumEventsSent(),this.AddDecodeMetrics(),this.AddStreamsReceivedMetric(),this.AddSyncErrorMetric(),this.AddCacheMetrics();var e=genvidproto.genvid.proto.ClientMetrics.encode({clientMetrics:this.clientMetricList}).finish();this.rpc.sendMsg(genvidproto.genvid.proto.LeafMethod.CLIENT_METRICS,e)},e.prototype.AddPlaybackRateMetric=function(){this.mediaPlayer&&this.mediaPlayer.getPlaybackRate&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"playback.rate",value:this.mediaPlayer.getPlaybackRate(),tags:this.emptyTags,operation:"GAUGE"}))},e.prototype.AddVideoPlayerBufferMetrics=function(){if(this.mediaPlayer&&this.mediaPlayer.getDeviationFromLatestFrame){var e=this.mediaPlayer.getDeviationFromLatestFrame();e>=0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"deviation.from.latest.frame",value:e,tags:this.emptyTags,operation:"GAUGE"}))}},e.prototype.AddCurrentVideoTimeMetric=function(){this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"videoTime",value:this.videoTimeMS,tags:this.emptyTags,operation:"GAUGE"}))},e.prototype.AddLatencyMetric=function(){this.numLatencyUpdates>0&&(this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"latency",value:this.latencyAggregate/this.numLatencyUpdates,tags:this.emptyTags,operation:"TIMING"})),this.latencyAggregate=0,this.numLatencyUpdates=0)},e.prototype.AddOnDrawMetrics=function(){this.numDrawCalls>0&&(this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.duration.mean",value:this.onDrawDurationAggregate/this.numDrawCalls,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.duration.min",value:this.onDrawDurationMin,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.duration.max",value:this.onDrawDurationMax,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.interval.mean",value:this.onDrawIntervalAggregate/this.numDrawCalls,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.interval.min",value:this.onDrawIntervalMin,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.interval.max",value:this.onDrawIntervalMax,tags:this.emptyTags,operation:"TIMING"})),this.numDrawCalls=0,this.onDrawDurationAggregate=0,this.onDrawDurationMin=1/0,this.onDrawDurationMax=0,this.onDrawIntervalAggregate=0,this.onDrawIntervalMin=1/0,this.onDrawIntervalMax=0)},e.prototype.AddDecodeMetrics=function(){this.numFrameDecodes>0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"frame.decode.duration",value:this.decodeFramesLength/this.numFrameDecodes,tags:this.emptyTags,operation:"TIMING"})),this.numNotifDecode>0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"notification.decode.duration",value:this.decodeNotificationsLength/this.numNotifDecode,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"frame.decode.errors",value:this.numFramesDecodeErrors,tags:this.emptyTags,operation:"GAUGE"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"notification.decode.errors",value:this.numNotificationDecodeErrors,tags:this.emptyTags,operation:"GAUGE"})),this.decodeFramesLength=0,this.numFrameDecodes=0,this.decodeNotificationsLength=0,this.numNotifDecode=0,this.numFramesDecodeErrors=0,this.numNotificationDecodeErrors=0},e.prototype.AddStreamsReceivedMetric=function(){this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"streams.interval",value:this.delayBetweenStreamsReceived/this.numOnStreamsReceived,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"streams.received.Hz",value:this.numOnStreamsReceived/this.sendMetricsPeriod,tags:this.emptyTags,operation:"GAUGE"})),this.delayBetweenStreamsReceived=0,this.numOnStreamsReceived=0},e.prototype.AddTwitchNTPTransportTime=function(){if(this.mediaPlayer){var e=getAverageNtpTransportTimeSinceLastCall(this.mediaPlayer);e>=0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"twitch.ntp.transport",value:e,tags:this.emptyTags,operation:"TIMING"}))}},e.prototype.AddDataMetrics=function(){var e,t,r,n;try{for(var i=__values(this.framesMetrics),o=i.next();!o.done;o=i.next())o.value.value/=this.sendMetricsPeriod}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}try{for(var s=__values(this.bytesMetrics),a=s.next();!a.done;a=s.next())a.value.value/=this.sendMetricsPeriod}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.clientMetricList=this.clientMetricList.concat(this.framesMetrics,this.bytesMetrics),this.framesMetrics=[],this.bytesMetrics=[]},e.prototype.AddNumEventsSent=function(){this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"events.sent.Hz",value:this.eventsSentSinceLastSentMetrics/this.sendMetricsPeriod,tags:this.emptyTags,operation:"GAUGE"})),this.eventsSentSinceLastSentMetrics=0},e.prototype.AddSyncErrorMetric=function(){this.syncErrorCounts>0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"sync.error.mean",value:this.syncErrorAggregate/this.syncErrorCounts,tags:this.emptyTags,operation:"GAUGE"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"sync.error.min",value:this.syncErrorMin,tags:this.emptyTags,operation:"GAUGE"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"sync.error.max",value:this.syncErrorMax,tags:this.emptyTags,operation:"GAUGE"})),this.syncErrorAggregate=0,this.syncErrorMin=1/0,this.syncErrorMax=0,this.syncErrorCounts=0},e.prototype.AddCacheMetrics=function(){var e,t,r,n;if(this.numCachePushUpdates>0){try{for(var i=__values(this.cacheByteCapacityMetrics),o=i.next();!o.done;o=i.next())o.value.value/=this.numCachePushUpdates}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}try{for(var s=__values(this.cacheTimeCapacityMetrics),a=s.next();!a.done;a=s.next())a.value.value/=this.numCachePushUpdates}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.clientMetricList=this.clientMetricList.concat(this.cacheByteCapacityMetrics,this.cacheTimeCapacityMetrics),this.numCachePushUpdates=0,this.cacheByteCapacityMetrics=[],this.cacheTimeCapacityMetrics=[]}},e.prototype.UpdateMetricsOnStreamReception=function(e){this.delayBetweenStreamsReceived+=Date.now()-this.lastStreamsReceivedTime,this.lastStreamsReceivedTime=Date.now(),this.numOnStreamsReceived+=e.annotations.length+e.streams.length,this.UpdateStreamMetrics(e.annotations,"annotation"),this.UpdateStreamMetrics(e.streams,"data")},e.prototype.UpdateStreamMetrics=function(e,t){var r,n,i,o,s="received."+t+".frames.Hz",a="received."+t+".bytes.Hz";try{for(var c=__values(e),u=c.next();!u.done;u=c.next()){var l=u.value,d=this.FindMetricIndex(this.framesMetrics,s,["stream",l.id]);if(d>=0?this.framesMetrics[d]?this.framesMetrics[d].value+=l.frames.length:error("Frame metric with index "+d+" is invalid"):this.framesMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:s,value:l.frames.length,tags:["stream",l.id],operation:"GAUGE"})),(d=this.FindMetricIndex(this.bytesMetrics,a,["stream",l.id]))<0&&(this.bytesMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:a,value:0,tags:["stream",l.id],operation:"GAUGE"})),d=this.bytesMetrics.length-1),this.bytesMetrics[d])try{for(var p=__values(l.frames),h=p.next();!h.done;h=p.next()){var m=h.value;this.bytesMetrics[d].value+=m.rawdata.byteLength}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}else error("Byte metric with index "+d+" is invalid")}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}},e.prototype.FindMetricIndex=function(e,t,r){var n,i,o=0;try{for(var s=__values(e),a=s.next();!a.done;a=s.next()){var c=a.value;if(c.key===t&&this.SameTags(c.tags,r))return o;o++}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return-1},e.prototype.SameTags=function(e,t){if(!e||!t||e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},e.prototype.UpdateSyncError=function(e){this.syncErrorCounts++,this.syncErrorAggregate+=e,this.syncErrorMin=Math.min(e,this.syncErrorMin),this.syncErrorMax=Math.max(e,this.syncErrorMax)},e.prototype.UpdateLatency=function(e){this.latencyAggregate+=e,this.numLatencyUpdates++},e.prototype.UpdatePreDraw=function(e){this.numDrawCalls++,0==this.onDrawPreviousTime&&(this.onDrawPreviousTime=e);var t=e-this.onDrawPreviousTime;this.onDrawIntervalAggregate+=t,this.onDrawIntervalMin=Math.min(this.onDrawIntervalMin,t),this.onDrawIntervalMax=Math.max(this.onDrawIntervalMax,t),this.onDrawPreviousTime=e},e.prototype.UpdatePostDraw=function(e){var t=Date.now()-e;this.onDrawDurationAggregate+=t,this.onDrawDurationMin=Math.min(this.onDrawDurationMin,t),this.onDrawDurationMax=Math.max(this.onDrawDurationMax,t)},e.prototype.UpdateCacheMetrics=function(e){var t=this;this.numCachePushUpdates++,e.forEach((function(e,r){e.forEach((function(e,r){var n=["stream",r],i=0;e.frames.forEach((function(e){i+=e.rawdata.byteLength}));var o=t.FindMetricIndex(t.cacheByteCapacityMetrics,"cached.bytes",n);if(o>=0?t.cacheByteCapacityMetrics[o].value+=i:t.cacheByteCapacityMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:"cached.bytes",value:i,tags:n,operation:"GAUGE"})),e.fps&&e.fps>0){var s=t.FindMetricIndex(t.cacheTimeCapacityMetrics,"cached.seconds",n);s>=0?t.cacheTimeCapacityMetrics[s].value+=e.frames.length/e.fps:t.cacheTimeCapacityMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:"cached.seconds",value:e.frames.length/e.fps,tags:n,operation:"GAUGE"}))}}))}))},e.prototype.registerConfigReception=function(){var e=this;this.rpc&&this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.METRICS_CONFIG,(function(t){var r=genvidproto.genvid.proto.MetricsConfig.decode(t);return e.sendMetricsPeriod=r.periodSeconds,r.enabled?e.startMetrics():e.stopMetrics(),new Uint8Array}))},e}();function newClientMetricManager(e,t){return new ClientMetricManager(e,t)}function getFrameSnapDistance(e,t,r){return function(n){var i=e-r(n);return i>0?i:i<-t?-1/0:-i}}function findMinimum(e,t,r){for(var n=-1,i=1/0,o=0;o<e.length;o++){var s=t(e[o]);if(s>=0&&s<=i)i=s,n=o;else if(r)break}return n}function lastIndexOf(e,t){for(var r=-1,n=0;n<e.length&&!1!==t(e[n]);n++)r=n;return r}function deepEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}var long_1=Long,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function isLong(e){return!0===(e&&e.__isLong__)}Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=UINT_CACHE[e])?n:(r=fromBits(e,(0|e)<0?-1:0,!0),i&&(UINT_CACHE[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=INT_CACHE[e])?n:(r=fromBits(e,e<0?-1:0,!1),i&&(INT_CACHE[e]=r),r)}function fromNumber(e,t){if(isNaN(e))return t?UZERO:ZERO;if(t){if(e<0)return UZERO;if(e>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(e+1>=TWO_PWR_63_DBL)return MAX_VALUE}return e<0?fromNumber(-e,t).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,t)}function fromBits(e,t,r){return new Long(e,t,r)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return ZERO;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return fromString(e.substring(1),t,r).neg();for(var i=fromNumber(pow_dbl(r,8)),o=ZERO,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),r);if(a<8){var u=fromNumber(pow_dbl(r,a));o=o.mul(u).add(fromNumber(c))}else o=(o=o.mul(i)).add(fromNumber(c))}return o.unsigned=t,o}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var t=fromNumber(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=fromNumber(pow_dbl(e,6),this.unsigned),o=this,s="";;){var a=o.div(i),c=(o.sub(a.mul(i)).toInt()>>>0).toString(e);if((o=a).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return 1==(1&this.low)},LongPrototype.isEven=function(){return 0==(1&this.low)},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return this.comp(e)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,a=e.low>>>16,c=0,u=0,l=0,d=0;return l+=(d+=i+(65535&e.low))>>>16,u+=(l+=n+a)>>>16,c+=(u+=r+s)>>>16,c+=t+o,fromBits((l&=65535)<<16|(d&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return ZERO;if(isLong(e)||(e=fromValue(e)),wasm)return fromBits(wasm.mul(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned);if(e.isZero())return ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,a=e.low>>>16,c=65535&e.low,u=0,l=0,d=0,p=0;return d+=(p+=i*c)>>>16,l+=(d+=n*c)>>>16,d&=65535,l+=(d+=i*a)>>>16,u+=(l+=r*c)>>>16,l&=65535,u+=(l+=n*a)>>>16,l&=65535,u+=(l+=i*s)>>>16,u+=t*c+r*a+n*s+i*o,fromBits((d&=65535)<<16|(p&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var t,r,n;if(wasm)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;n=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(t=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=ZERO}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:pow_dbl(2,i-48),s=fromNumber(t),a=s.mul(e);a.isNegative()||a.gt(r);)a=(s=fromNumber(t-=o,this.unsigned)).mul(e);s.isZero()&&(s=ONE),n=n.add(s),r=r.sub(a)}return n},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){if(isLong(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?fromBits(this.low>>>e|t<<32-e,t>>>e,this.unsigned):fromBits(32===e?t:t>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,r){return r?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var kSystemSessionID="4294967295";function syncFrameToSyncData(e){return{pts:(e.pts?e.pts instanceof long_1?e.pts.toNumber():e.pts:0)/1e3,sendingTime:(e.sendingTime?e.sendingTime instanceof long_1?e.sendingTime.toNumber():e.sendingTime:0)/1e3,startIngestTime:(e.startIngestTime?e.startIngestTime instanceof long_1?e.startIngestTime.toNumber():e.startIngestTime:0)/1e3}}var DataStreamFrame=function(){function e(e,t,r){this.sessionid=e,this.streamId=t,this.user=void 0;var n=new ArrayBuffer(0);if(r.data){n=new ArrayBuffer(r.data.byteLength);for(var i=new Uint8Array(n),o=0;o<r.data.byteLength;o++)i[o]=r.data[o]}this.rawdata=n,this.pts=r.pts,this.sendingTime=r.sendingTime,this.startIngestTime=r.startIngestTime,this.timeCode=r.timecode,this.timestamp=r.timestamp,this.composition=r.composition}return Object.defineProperty(e.prototype,"data",{get:function(){return UTF8ToString(this.rawdata)},enumerable:!0,configurable:!0}),e.prototype.getCompositionData=function(){var e={composition:[{affineMatrix:[1,0,0,0,1,0,0,0,1],class:this.composition.item&&this.composition.item.classname||"",opacity:1,streamId:this.streamId,sessionId:""+(this.composition.item&&this.composition.item.sessionid),timestamp:this.composition.item&&this.composition.item.timestamp||0,type:this.composition.item?this.composition.item.videoSourceCompositionType:"Undefined"}],pts:this.pts,sending_time:this.sendingTime,start_ingest_time:this.startIngestTime,syncTime:0};if(this.composition.components&&this.composition.components.affine&&this.composition.components.affine.matrix&&this.composition.components.affine.source){var t=this.composition.components.affine.matrix,r=[t.c0r0||0,t.c0r1||0,t.c0r2||0,t.c1r0||0,t.c1r1||0,t.c1r2||0,t.c2r0||0,t.c2r1||0,t.c2r2||0];e.composition.push({affineMatrix:r,class:this.composition.components.affine.source.classname||"",opacity:this.composition.components.affine.opacity||0,streamId:this.streamId,sessionId:""+this.composition.components.affine.source.sessionid,timestamp:this.composition.components.affine.source.timestamp||0,type:this.composition.item?this.composition.item.videoSourceCompositionType:"Undefined"})}return e},e}(),DataNotification=function(){function e(e,t,r){this.sessionid=e,this.id=t,this.rawdata=r}return Object.defineProperty(e.prototype,"data",{get:function(){return UTF8ToString(this.rawdata)},enumerable:!0,configurable:!0}),e}(),DefaultComposition;!function(e){e[e.SessionId=4294967295]="SessionId",e[e.SourceId=4294967295]="SourceId",e[e.StreamId=4294967295]="StreamId"}(DefaultComposition||(DefaultComposition={}));var GenvidClient=function(){function e(e,t,r,n,i){void 0===i&&(i={});var o=this;this.apiStreams=e,this.url=t,this.token=r,this.videoDivId=n,this.videoElemId="",this.videoWidth=0,this.videoHeight=0,this.videoAspectRatio=1280/720,this.rpc=newRpcWrapper(),this.frameRate=30,this.requestCount=0,this.onSyncIntervalHandle=0,this.connectionTimer=0,this.syncInterval=0,this.compositionCache=new Map,this.streamInfoCache=new Map,this.playerReady=!1,this.gameDataMaxAge=8,this.syncData=[],this.streamTimeSmoother=newTimeSmoother(),this.delayOffset=0,this.isAuthenticated=!1,this.streamLatencyMS=0,this.videoTimeMS=0,this.streamTimeMS=0,this.lastComposeTimeMS=0,this.composeTimeMS=0,this.syncTimeSmoother=newTimeSmoother(),this.syncError=0,this.targetCaptureCount=100,this.activateCapture=!1,this.currentCaptureCount=0,this.onCaptureData=function(){return warn("onCaptureData callback missing!"),!0},this.debugLevel=0,this.lastSyncTime=0,this.lastNow=0,this.lastSyncTimeReceived=0,this.startSyncTime=0,this.startWallTime=0,this.benchFrameNum=-1,this.StreamFormat=genvidproto.genvid.proto.StreamFormat,this.DataFrames=genvidproto.genvid.proto.DataFrames,this.DataNotifications=genvidproto.genvid.proto.DataNotifications,this.Event=genvidproto.genvid.proto.Event,this.hasNewSessionId=!1,this.lastStreamInfoSent={},this.videoPlayerOptions={},this.isFirstStreamInfo=!0,this.version=version,log("Genvid SDK version "+this.version+" initializing."),this.streamsFormat={},this.closedStreams={},this.streams=new Map,this.annotations=new Map,this.videoPlayerOptions=i,this.streamsFormat[DefaultComposition.SessionId]={},this.streamsFormat[DefaultComposition.SessionId][DefaultComposition.SourceId]={},this.streamsFormat[DefaultComposition.SessionId][DefaultComposition.SourceId][DefaultComposition.StreamId]={sessionName:"0",sourceName:"",streamName:"genvid.encoded",fps:1,alive:!0},this.gameDataMaxAge=getConfig().gameDataMaxAge,this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.STREAM_FORMAT,(function(e){var t=o.StreamFormat.decode(e);o.streamsFormat[t.sessionId]=o.streamsFormat[t.sessionId]||{},o.streamsFormat[t.sessionId][t.sourceId]=o.streamsFormat[t.sessionId][t.sourceId]||{},o.streamsFormat[t.sessionId][t.sourceId][t.streamId]={sessionName:String(t.sessionId),sourceName:t.sourceName,streamName:t.streamName,fps:t.fps,alive:t.alive};var r=String(t.sessionId);return o.closedStreams[r]=o.closedStreams[r]||{},o.closedStreams[r][t.streamName]=!t.alive,r===DefaultComposition.SessionId.toString(10)||o.hasNewSessionId||(o.hasNewSessionId=!0),new Uint8Array})),this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.DATA_FRAMES,(function(e){var t=Date.now(),r=o.DataFrames.decode(e);try{o.receivedFrames(r)}catch(e){o.metricManager.numFramesDecodeErrors++,error(e)}return o.metricManager.numFrameDecodes++,o.metricManager.decodeFramesLength+=Date.now()-t,new Uint8Array})),this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.DATA_NOTIFICATIONS,(function(e){var t=Date.now(),r=o.DataNotifications.decode(e);try{o.receivedNotifications(r)}catch(e){o.metricManager.numNotificationDecodeErrors++,error(e)}return o.metricManager.decodeNotificationsLength+=Date.now()-t,o.metricManager.numNotifDecode++,new Uint8Array})),this.apiStreams&&(this.delayOffset=this.apiStreams.delayoffset,this.apiStreams.videowidth&&(this.videoWidth=this.apiStreams.videowidth),this.apiStreams.videoheight&&(this.videoHeight=this.apiStreams.videoheight),this.videoWidth*this.videoHeight>0&&(this.videoAspectRatio=this.videoWidth/this.videoHeight),this.initVideoPlayer(i)),this.metricManager=newClientMetricManager(this.rpc,this.videoPlayer)}return e.prototype.initVideoPlayer=function(e){var t=this.privateOnVideoPlayerReady.bind(this);switch(this.apiStreams.service||"twitch"){case"fake":this.videoPlayer=newFakePlayer(this.videoDivId,this.apiStreams.channel,t,e);break;case"twitch":e.twitchExt?this.videoPlayer=newTwitchExtPlayer(this.videoDivId,this.apiStreams.channel,t,e,this.apiStreams.ntpuri||""):this.videoPlayer=newTwitchPlayer(this.videoDivId,this.apiStreams.channel,t,e,this.apiStreams.ntpuri||"");break;case"youtube":this.videoPlayer=newYouTubePlayer(this.videoDivId,this.apiStreams.channel,t,e);break;case"facebook":this.videoPlayer=newFacebookPlayer(this.videoDivId,this.apiStreams.channel,t,e);break;case"standalone":this.videoPlayer=newStandalonePlayer(this.videoDivId,this.apiStreams.channel,t,e);break;default:return error("Unsupported streaming service: '"+this.apiStreams.service+"'.")}this.videoPlayer.getCurrentTime()},e.prototype.privateOnVideoPlayerReady=function(e){this.playerReady=!0,this.videoElem=e,this.onVideoPlayerReadyCallback&&this.onVideoPlayerReadyCallback(e)},e.prototype.onDisconnect=function(e){this.onDisconnectCallback=e},e.prototype.onVideoPlayerReady=function(e){this.onVideoPlayerReadyCallback=e,this.playerReady&&e(this.videoElem)},e.prototype.onDraw=function(e){this.onDrawCallback=e},e.prototype.onStreamsReceived=function(e){this.onStreamsReceivedCallback=e},e.prototype.onNotificationsReceived=function(e){this.onNotificationsReceivedCallback=e},e.prototype.startFrameCapture=function(e,t){this.activateCapture?warn("Capture in progress, please wait !"):(this.targetCaptureCount=t,log("Capture started: "+this.targetCaptureCount+" frames to be captured at "+1e3/this.syncInterval+" fps"),log("Note that this feature is for internal use only, this API is subject to change."),this.onCaptureData=e||this.onCaptureData,this.activateCapture=!0)},e.prototype.convertToDataStreams=function(e){var t=this;return this.hasNewSessionId?{streams:(e.streams||[]).map((function(e){return{id:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName||"",sessionid:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName||"",fps:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].fps||30,frames:(e.frames||[]).map((function(r){return new DataStreamFrame(t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName||"",t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName||"",r)}))}})),annotations:(e.annotations||[]).map((function(e){return{id:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName:"",sessionid:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName:"",frames:(e.frames||[]).map((function(r){return new DataStreamFrame(t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName:"",t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName:"",r)}))}}))}:{annotations:[],streams:[]}},e.prototype.receivedFrames=function(e){var t,r,n,i,o,s,a,c,u,l,d,p,h,m,f,g=this.convertToDataStreams(e);this.metricManager.UpdateMetricsOnStreamReception(g);var y=new Set;try{for(var v=__values(g.streams),w=v.next();!w.done;w=v.next())switch((R=w.value).sessionid){case kSystemSessionID:switch(R.id){case"sync":y.add(R.id);var b=new Date;try{for(var S=__values(R.frames),T=S.next();!T.done;T=S.next()){var I=T.value,O=new Uint8Array(I.rawdata),P=genvidproto.genvid.proto.SyncFrame.decode(O);this.videoPlayer&&(P.syncTime=this.videoPlayer.getSyncTime(syncFrameToSyncData(P))),this.syncData.length&&P.syncTime<this.syncData[this.syncData.length-1].syncTime&&this.clearDataCaches(),this.syncData.push(P),this.lastComposeTimeMS=P.syncTime,this.syncTimeSmoother.set(P.syncTime,b)}}catch(e){n={error:e}}finally{try{T&&!T.done&&(i=S.return)&&i.call(S)}finally{if(n)throw n.error}}break;case"composition":y.add(R.id);try{for(var _=__values(R.frames),E=_.next();!E.done;E=_.next()){I=E.value,O=new Uint8Array(I.rawdata);var A=genvidproto.genvid.proto.CompositionFrame.decode(O);if(A.composition&&this.videoPlayer){var M=this.videoPlayer.getSyncTime(syncFrameToSyncData(A)),x=protoToCompositiondata(A.composition);this.compositionCache.set(M,x)}}}catch(e){o={error:e}}finally{try{E&&!E.done&&(s=_.return)&&s.call(_)}finally{if(o)throw o.error}}break;case"stream_info":y.add(R.id);try{for(var L=__values(R.frames),C=L.next();!C.done;C=L.next()){I=C.value;var k=JSON.parse(I.data);this.videoPlayer&&(M=this.videoPlayer.getSyncTime(syncFrameToSyncData(k)),this.streamInfoCache.set(M,k.streamInfo))}}catch(e){a={error:e}}finally{try{C&&!C.done&&(c=L.return)&&c.call(L)}finally{if(a)throw a.error}}if(this.videoPlayerOptions.hasOwnProperty("reloadVideoPlayer")&&!0===this.videoPlayerOptions.reloadVideoPlayer)if(!0===this.isFirstStreamInfo)this.isFirstStreamInfo=!1;else if(this.videoPlayer&&this.videoPlayer.reloadVideoPlayer){var N=JSON.parse(R.frames[R.frames.length-1].data).streamInfo.channel;""!=N&&this.videoPlayer.reloadVideoPlayer(N)}else warn("reloadVideoPlayer is not available on your streaming service.")}}}catch(e){t={error:e}}finally{try{w&&!w.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}g.streams=g.streams.filter((function(e){return!y.has(e.id)})),this.onStreamsReceivedCallback&&this.onStreamsReceivedCallback(g);try{for(var $=__values(g.streams),D=$.next();!D.done;D=$.next()){var R=D.value;(V=this.streams.get(R.sessionid))||(V=new Map,this.streams.set(R.sessionid,V)),(W=V.get(R.id))||(W={fps:R.fps,frames:[]},V.set(R.id,W));try{for(var B=__values(R.frames),j=B.next();!j.done;j=B.next())I=j.value,(0===W.frames.length||W.frames[W.frames.length-1].timeCode<I.timeCode)&&W.frames.push(I)}catch(e){d={error:e}}finally{try{j&&!j.done&&(p=B.return)&&p.call(B)}finally{if(d)throw d.error}}}}catch(e){u={error:e}}finally{try{D&&!D.done&&(l=$.return)&&l.call($)}finally{if(u)throw u.error}}this.metricManager.UpdateCacheMetrics(this.streams);try{for(var F=__values(g.annotations),U=F.next();!U.done;U=F.next()){var V,W,z=U.value;(V=this.annotations.get(z.sessionid))||(V=new Map,this.annotations.set(z.sessionid,V)),(W=V.get(z.id))||(W={frames:[]},V.set(z.id,W)),(f=W.frames).push.apply(f,__spread(z.frames))}}catch(e){h={error:e}}finally{try{U&&!U.done&&(m=F.return)&&m.call(F)}finally{if(h)throw h.error}}},e.prototype.clearDataCaches=function(){this.syncData=[],this.compositionCache.clear(),this.clearFramesFromNestedMaps(this.streams),this.clearFramesFromNestedMaps(this.annotations)},e.prototype.clearFramesFromNestedMaps=function(e){var t,r,n,i;try{for(var o=__values(this.streams),s=o.next();!s.done;s=o.next()){var a=__read(s.value,2),c=(a[0],a[1]);try{for(var u=__values(c),l=u.next();!l.done;l=u.next()){var d=__read(l.value,2);d[0],d[1].frames=[]}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.receivedNotifications=function(e){var t,r;if(this.onNotificationsReceivedCallback){var n=[];try{for(var i=__values(e.notifications),o=i.next();!o.done;o=i.next()){var s=o.value,a=new ArrayBuffer(0);if(s.data){a=new ArrayBuffer(s.data.byteLength);for(var c=new Uint8Array(a),u=0;u<s.data.byteLength;u++)c[u]=s.data[u]}n.push(new DataNotification(s.sessionid||"",s.id||"",a))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}this.onNotificationsReceivedCallback({notifications:n})}},e.prototype.onSyncInterval=function(){var e,t,r,n,i,o,s=this;if(this.videoPlayer){if(this.syncData.length){var a=this.videoPlayer.getCurrentTime();if(!(a<0)&&this.streamsFormat){var c=a+this.delayOffset,u=c-1e3*this.gameDataMaxAge,l=getFrameSnapDistance(c,this.syncInterval/2,(function(e){return e.syncTime||0})),d=findMinimum(this.syncData,l,!0);if(d<0)warn("No sync data found");else{var p=lastIndexOf(this.syncData,(function(e){return e.syncTime<=u})),h=this.syncData[p],m=h?h.syncTime:0,f=this.syncData[d],g=[],y={},v=-1,w=[];try{for(var b=__values(this.compositionCache),S=b.next();!S.done;S=b.next()){var T=__read(S.value,2),I=T[0],O=T[1];if(I>(f.syncTime||0))break;m>I&&w.push(I),g=O,v=I}}catch(t){e={error:t}}finally{try{S&&!S.done&&(t=b.return)&&t.call(b)}finally{if(e)throw e.error}}for(;w.length&&w[w.length-1]>=v;)w.pop();var P=[],_=-1;try{for(var E=__values(this.streamInfoCache),A=E.next();!A.done;A=E.next()){var M=__read(A.value,2),x=(I=M[0],M[1]);if(I>(f.syncTime||0))break;m>I&&P.push(I),y=x,_=I}}catch(e){r={error:e}}finally{try{A&&!A.done&&(n=E.return)&&n.call(E)}finally{if(r)throw r.error}}for(;P.length&&P[P.length-1]>=_;)P.pop();if(deepEqual(this.lastStreamInfoSent,y)||(this.lastStreamInfoSent=y),this.syncError=(f.syncTime||0)-c,this.metricManager.UpdateSyncError(this.syncError),this.debugLevel>0){var L=Date.now(),C=(f.syncTime||0)-this.lastSyncTime;if(this.debugLevel>=2&&C<.025||C>.045?error("syncTime:",f.syncTime," deltaSyncTime:",C," now:",L/1e3," dt:",(L-this.lastNow)/1e3," videoTime:",a):this.debugLevel>=2&&log("syncTime:",f.syncTime," deltaSyncTime:",C," now:",L/1e3," dt:",(L-this.lastNow)/1e3," videoTime:",a),-1===this.benchFrameNum)this.startSyncTime=f.syncTime||0,this.startWallTime=L,this.benchFrameNum=0;else if(this.benchFrameNum++,1e3===this.benchFrameNum){this.benchFrameNum=-1;var k=L-this.startWallTime,N=(f.syncTime||0)-this.startSyncTime;log("****** benchmark dura:",k/1e3," video length:",N," error:",(k/1e3-N/1e3)/k*100)}this.lastSyncTime=f.syncTime||0,this.lastNow=L}var $={timeCode:-1,streams:{},annotations:{},sessions:{},compositionData:[]},D=function(e,t){var r,n,i;if(e=1e3*(e||0),h)try{for(var o=__values(h.sources),a=o.next();!a.done;a=o.next()){var c=a.value;if(c.sessionId===t){i=c;break}}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}var u=""+t;$.sessions[u]=$.sessions[u]||{streams:{},annotations:{}};var l=R.streams.get(u),d=R.annotations.get(u),p=getFrameSnapDistance(e,R.syncInterval/2,(function(e){return e.timeCode}));l&&l.forEach((function(e,t){if(e){var r=e.frames,n=findMinimum(r,p,!0);if(n>=0&&($.sessions[u].streams[t]=r[n]),i){for(var o=-1,a=0;a<r.length&&r[a].timeCode<1e3*(i.timestamp||0);a++)o=a;o>=1?r.splice(0,o):0===o&&!0===s.closedStreams[u][t]&&(r=[])}}})),d&&d.forEach((function(e,t){if(e&&e.frames.length){var r=e.frames,n=findMinimum(r,p,!0);$.sessions[u].annotations[t]=n>=0?r.splice(0,n+1):[]}}))},R=this;try{for(var B=__values(f.sources||[]),j=B.next();!j.done;j=B.next()){var F=j.value;D(V=F.timestamp,W=F.sessionId)}}catch(e){i={error:e}}finally{try{j&&!j.done&&(o=B.return)&&o.call(B)}finally{if(i)throw i.error}}if(f.sources&&0!==f.sources.length){var U=f.sources[0],V=U.timestamp,W=U.sessionId;($=__assign({},$,$.sessions[""+W])).timeCode=1e3*(V||0)}else warn("composition is empty");var z=new Date;if(this.videoTimeMS=a,this.metricManager.videoTimeMS=this.videoTimeMS,this.composeTimeMS=this.syncTimeSmoother.get(z),this.streamTimeMS=f.syncTime||0,this.streamLatencyMS=this.composeTimeMS-this.streamTimeMS,this.metricManager.UpdateLatency(this.streamLatencyMS),p>1&&(this.syncData.splice(0,p),w.forEach((function(e){return s.compositionCache.delete(e)})),P.forEach((function(e){return s.streamInfoCache.delete(e)}))),$.compositionData=g,this.activateCapture&&f.syncTime&&f.sources&&f.sources.length&&(this.currentCaptureCount++,this.activateCapture=this.onCaptureData({playerTime:c,computedSyncTime:f.syncTime,compositionTime:f.sources[0].timestamp||0,clockTime:performance.now(),frameData:$}),this.currentCaptureCount>=this.targetCaptureCount&&(this.currentCaptureCount=0,this.activateCapture=!1,this.onCaptureData(void 0),log("Capture complete."))),this.onDrawCallback){var G=Date.now();this.metricManager.UpdatePreDraw(G),this.onDrawCallback($),this.metricManager.UpdatePostDraw(G)}}}}}else warn("no video player")},e.prototype.buildEvents=function(e,t){t=t||[];var r=[];for(var n in e){t.push(n);var i=e[n],o=typeof i;switch(o){case"string":case"number":case"boolean":var s={key:__spread(t),value:i};r.push(s);break;case"object":var a=this.buildEvents(i,__spread(t));r.push.apply(r,__spread(a));break;default:throw new Error("Does not support type "+o)}t.pop()}return r},e.prototype.wsOnOpen=function(e){info("Connected to leaf:",this.url),this.connectionTimer&&getConfig().window.clearTimeout(this.connectionTimer)},e.prototype.wsOnMessage=function(e){if(!this.isAuthenticated&&(info("Authentication succeeded"),this.isAuthenticated=!0,this.onAuthenticatedCallback))try{this.onAuthenticatedCallback(!0)}catch(e){error(e),this.metricManager.stopMetrics(),this.ws&&this.ws.close()}},e.prototype.wsOnError=function(e){error("Web socket error",e),this.metricManager.stopMetrics()},e.prototype.wsOnClose=function(e){info("Web socket closed ["+e.code+"]: "+e.reason),this.metricManager.stopMetrics(),this.onAuthenticatedCallback&&!1===this.isAuthenticated&&this.onAuthenticatedCallback(!1),this.isAuthenticated=!1,this.onDisconnectCallback&&this.onDisconnectCallback()},e.prototype.onAuthenticated=function(e){this.onAuthenticatedCallback=e},e.prototype.sendEvent=function(e){var t,r,n=[];try{for(var i=__values(e),o=i.next();!o.done;o=i.next()){var s=o.value;n.push({key:s.key,value:JSON.stringify(s.value)})}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}var a=this.Event.encode({keyValue:n}).finish();this.rpc.sendMsg(genvidproto.genvid.proto.LeafMethod.EVENT,a),this.metricManager.eventsSentSinceLastSentMetrics++},e.prototype.sendEventObject=function(e){this.sendEvent(this.buildEvents(e))},e.prototype.start=function(){var e=this;try{var t=getConfig(),r=t.websocketConnectionTimeout,n=t.framePerSeconds,i=(0,t.newWebsocket)(this.url+"?token="+this.token+"&version="+this.version);this.ws=i,i.binaryType="arraybuffer",this.rpc.init(i,(function(t){e.wsOnMessage(t)})),i.onopen=function(t){e.wsOnOpen(t)},i.onerror=function(t){e.wsOnError(t)},i.onclose=function(t){e.wsOnClose(t)},n=n||30;var o=1e3*(r=r||60);this.connectionTimer=t.window.setTimeout((function(){e.ws&&e.ws.readyState===e.ws.CONNECTING&&(error("Timeout during web socket connection.  Closing"),e.ws.close())}),o),this.syncInterval=1e3/n-2,log("OnDraw interval is set to "+this.syncInterval+" ms"),this.onSyncIntervalHandle=t.window.setInterval((function(){try{e.onSyncInterval()}catch(e){error(e)}}),this.syncInterval)}catch(e){error(e)}},e.prototype.reconnect=function(e,t,r){this.close(),info("Reconnecting GenvidClient websocket..."),e&&(this.apiStreams=e,this.videoPlayer&&this.videoPlayer.setStreamInfo&&this.videoPlayer.setStreamInfo(e)),t&&(this.url=t),r&&(this.token=r),this.start()},e.prototype.close=function(){info("Closing GenvidClient"),this.onSyncIntervalHandle&&(clearInterval(this.onSyncIntervalHandle),delete this.onSyncIntervalHandle),this.videoPlayer&&this.videoPlayer.close&&this.videoPlayer.close(),this.ws&&this.ws.close()},e}();function createGenvidClient(e,t,r,n,i){return new GenvidClient(e,t,r,n,i)}var WebGLContext=function(){function e(e){this.div=e,this.clearColor=[0,0,0,0];var t=e.getContext("webgl",{premultipliedAlpha:!0})||e.getContext("experimental-webgl",{premultipliedAlpha:!0});if(!t)throw alert("This browser doesn't support WebGL"),Error("This browser doesn't support WebGL");this.gl=t,this.div.addEventListener("webglcontextlost",this.handleContextLost,!1),this.div.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this.init()}return e.prototype.init=function(){this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LESS),this.resizeToDisplaySize()},e.prototype.clear=function(){var e,t=this.clearColor;t.x?this.gl.clearColor(t.x,t.y,t.z,t.w):(e=this.gl).clearColor.apply(e,__spread(this.clearColor)),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.checkGLError()},e.prototype.checkGLError=function(){var e=this.gl.getError();e!==this.gl.NO_ERROR&&log("GL Error: "+e)},e.prototype.handleContextLost=function(){this.handleContextLost&&this.handleContextLost()},e.prototype.handleContextRestored=function(){this.handleContextRestored&&this.handleContextRestored()},e.prototype.resizeToDisplaySize=function(){var e=this.div;this.setResolution(e.clientWidth,e.clientHeight)},e.prototype.setResolution=function(e,t){var r=this.gl.canvas;r.width===e&&r.height===t||(r.width=e,r.height=t,this.gl.viewport(0,0,r.width,r.height))},e.prototype.setViewport=function(e,t,r,n){this.gl.viewport(e,t,r,n)},e.prototype.loadShader=function(e,t){var r=this.gl.createShader(e);if(!r)throw Error("Failed to create shader "+e);if(this.gl.shaderSource(r,t),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)&&!this.gl.isContextLost()){var n=this.gl.getShaderInfoLog(r);throw this.gl.deleteShader(r),Error("Error compiling shader: "+n)}return r},e.prototype.loadVertexShader=function(e){return this.loadShader(this.gl.VERTEX_SHADER,e)},e.prototype.loadFragmentShader=function(e){return this.loadShader(this.gl.FRAGMENT_SHADER,e)},e.prototype.deleteShader=function(e){this.gl.deleteShader(e)},e.prototype.loadProgram=function(e,t,r){var n=this.gl.createProgram();if(!n)throw Error("GL: Unable to create program");if(this.gl.attachShader(n,e),this.gl.attachShader(n,t),r)for(var i=r.length,o=0;o<i;++o){var s=r[o];s&&this.gl.bindAttribLocation(n,o,s)}if(this.gl.linkProgram(n),!this.gl.getProgramParameter(n,this.gl.LINK_STATUS)&&!this.gl.isContextLost()){var a=this.gl.getProgramInfoLog(n);throw this.gl.deleteProgram(n),Error("Error linking program: "+a)}return n},e.prototype.deleteProgram=function(e){this.gl.deleteProgram(e)},e.prototype.createBuffer=function(e){var t=this.gl.createBuffer();if(!t)throw Error("Failed while trying to create gl buffer");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t);var r=0;return e&&(this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),r=e.length),[t,r]},e.prototype.createIndexBuffer=function(e){var t=this.gl.createBuffer();if(!t)throw Error("GL: Unable to create buffer");this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t);var r=0;return e&&(this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,e,this.gl.STATIC_DRAW),r=e.length),[t,r]},e.prototype.createIndexBufferForQuads=function(e){for(var t=[],r=0;r<e;++r){var n=4*r;t.push(n),t.push(n+1),t.push(n+2),t.push(n),t.push(n+2),t.push(n+3)}return this.createIndexBuffer(new Uint16Array(t))},e.prototype.deleteBuffer=function(e){this.gl.deleteBuffer(e)},e}();function createWebGLContext(e){return new WebGLContext(e)}}.call(this,__webpack_require__(2))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e,t,r){return Math.abs(t-e)<=r}function i(e,t){return{x:e,y:t}}function o(e,t,r){return n(e.x,t.x,r)&&n(e.y,t.y,r)}function s(e,t,r){return Math.min(Math.max(e,t),r)}function a(e,t,r){return e+(t-e)*r}function c(e,t){return{x:e.x+t.x,y:e.y+t.y}}function u(e,t){return{x:e.x-t.x,y:e.y-t.y}}function l(e,t){return{x:e.x*t.x,y:e.y*t.y}}function d(e,t){return{x:e.x*t,y:e.y*t}}function p(e,t,r){return{x:e.x*t.x+r.x,y:e.y*t.y+r.y}}function h(e){return e.x*e.x+e.y*e.y}function m(e){return Math.sqrt(h(e))}function f(e,t){return e.x*t.x+e.y*t.y}function g(e){var t=h(e);return t>1e-5?d(e,1/Math.sqrt(t)):e}function y(e,t,r){return c(e,d(t,r))}function v(e,t){return f(e,t)/h(t)}function w(e,t){return d(t,v(e,t))}function b(e,t,r){var n=u(r,t);return y(t,n,v(u(e,t),n))}function S(e){if(9!==e.length)throw new Error("Cannot convert this object into a matrix, wrong size: "+e.length);var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],s=e[5],a=e[6],c=e[7],u=e[8];return G(_(t,i,a),_(r,o,c),_(n,s,u))}function T(e){return[e.rows[0].x,e.rows[1].x,e.rows[2].x,e.rows[0].y,e.rows[1].y,e.rows[2].y,e.rows[0].z,e.rows[1].z,e.rows[2].z]}function I(e,t,r){var n=u(r,t),i=v(u(e,t),n);return h(u(y(t,n,i=s(i,0,1)),e))}function O(e,t,r){return Math.sqrt(I(e,t,r))}function P(e,t,r){var n=v(u(e,t),r);return s(n,0,1)}function _(e,t,r){return{x:e,y:t,z:r}}function E(e,t,r){return n(e.x,t.x,r)&&n(e.y,t.y,r)&&n(e.z,t.z,r)}function A(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}}function M(e,t){return{x:e.x-t.x,y:e.y-t.y,z:e.z-t.z}}function x(e,t){return{x:e.x*t.x,y:e.y*t.y,z:e.z*t.z}}function L(e,t){return{x:e.x*t,y:e.y*t,z:e.z*t}}function C(e,t,r){return{x:e.x*t.x+r.x,y:e.y*t.y+r.y,z:e.z*t.z+r.z}}function k(e){return e.x*e.x+e.y*e.y+e.z*e.z}function N(e){return Math.sqrt(k(e))}function $(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function D(e){var t=k(e);return t>1e-5?L(e,1/Math.sqrt(t)):e}function R(e,t,r,n){return{x:e,y:t,z:r,w:n}}function B(e,t,r){return n(e.x,t.x,r)&&n(e.y,t.y,r)&&n(e.z,t.z,r)&&n(e.w,t.w,r)}function j(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}function F(e,t){return{x:e.x*t,y:e.y*t,z:e.z*t,w:e.w*t}}function U(e){var t=e.w;return 1!==t&&0!==t?F(e,1/t):e}function V(e){var t=e.z;return 1!==t&&0!==t?L(e,1/t):e}function W(){return{rows:[_(1,0,0),_(0,1,0),_(0,0,1)]}}function z(e,t,r,n){return{rows:[e,t,r,n]}}function G(e,t,r){return{rows:[e,t,r]}}function q(e,t){var r=Z(t);return G(J(r,e.rows[0]),J(r,e.rows[1]),J(r,e.rows[2]))}function Y(e,t){return R(j(e.rows[0],t),j(e.rows[1],t),j(e.rows[2],t),j(e.rows[3],t))}function J(e,t){return _($(e.rows[0],t),$(e.rows[1],t),$(e.rows[2],t))}function H(e){var t=e.rows[0],r=e.rows[1],n=e.rows[2],i=e.rows[3];return z(R(t.x,r.x,n.x,i.x),R(t.y,r.y,n.y,i.y),R(t.z,r.z,n.z,i.z),R(t.w,r.w,n.w,i.w))}function Z(e){var t=e.rows[0],r=e.rows[1],n=e.rows[2];return G(_(t.x,r.x,n.x),_(t.y,r.y,n.y),_(t.z,r.z,n.z))}function Q(e,t){return U(Y(e,R(t.x,t.y,t.z,1)))}function X(e,t){return V(J(e,_(t.x,t.y,1)))}function K(e){var t=Math.round;return void 0!==e.x&&void 0!==e.y&&void 0!==e.z?void 0!==e.w?"rgba("+[t(255*e.x),t(255*e.y),t(255*e.z),e.w].join(",")+")":"rgb("+[t(255*e.x),t(255*e.y),t(255*e.z)].join(",")+")":void 0!==e.r&&void 0!==e.g&&void 0!==e.b?void 0!==e.a?"rgba("+[t(255*e.r),t(255*e.g),t(255*e.b),e.a].join(",")+")":"rgb("+[t(255*e.r),t(255*e.g),t(255*e.b)].join(",")+")":void 0}r.r(t),r.d(t,"equal",(function(){return n})),r.d(t,"vec2",(function(){return i})),r.d(t,"equal2D",(function(){return o})),r.d(t,"clamp",(function(){return s})),r.d(t,"mix",(function(){return a})),r.d(t,"add2D",(function(){return c})),r.d(t,"sub2D",(function(){return u})),r.d(t,"mul2D",(function(){return l})),r.d(t,"muls2D",(function(){return d})),r.d(t,"mad2D",(function(){return p})),r.d(t,"lengthSq2D",(function(){return h})),r.d(t,"length2D",(function(){return m})),r.d(t,"dot2D",(function(){return f})),r.d(t,"normalize2D",(function(){return g})),r.d(t,"evalLine2D",(function(){return y})),r.d(t,"getProjectionFactor2D",(function(){return v})),r.d(t,"projectUnto2D",(function(){return w})),r.d(t,"projectPointUntoSegment2D",(function(){return b})),r.d(t,"mat3FromArray",(function(){return S})),r.d(t,"mat3ToArray",(function(){return T})),r.d(t,"getSquaredDistanceToSegment2D",(function(){return I})),r.d(t,"getDistanceToSegment2D",(function(){return O})),r.d(t,"getParameter_ClosestPointToSegment2D",(function(){return P})),r.d(t,"vec3",(function(){return _})),r.d(t,"equal3D",(function(){return E})),r.d(t,"add3D",(function(){return A})),r.d(t,"sub3D",(function(){return M})),r.d(t,"mul3D",(function(){return x})),r.d(t,"muls3D",(function(){return L})),r.d(t,"mad3D",(function(){return C})),r.d(t,"lengthSq3D",(function(){return k})),r.d(t,"length3D",(function(){return N})),r.d(t,"dot3D",(function(){return $})),r.d(t,"normalize3D",(function(){return D})),r.d(t,"vec4",(function(){return R})),r.d(t,"equal4D",(function(){return B})),r.d(t,"dot4D",(function(){return j})),r.d(t,"muls4D",(function(){return F})),r.d(t,"homogenize4D",(function(){return U})),r.d(t,"homogenize3D",(function(){return V})),r.d(t,"mat3Identity",(function(){return W})),r.d(t,"mat4",(function(){return z})),r.d(t,"mat3",(function(){return G})),r.d(t,"prodmat3",(function(){return q})),r.d(t,"mulmat4",(function(){return Y})),r.d(t,"mulmat3",(function(){return J})),r.d(t,"transposemat4",(function(){return H})),r.d(t,"transposemat3",(function(){return Z})),r.d(t,"projectPosition",(function(){return Q})),r.d(t,"projectPosition2",(function(){return X})),r.d(t,"toHTMLColorString",(function(){return K})),r.d(t,"Path2",(function(){return ee}));var ee=function(){function e(e){void 0===e&&(e=[]),this.points=e.map((function(e){return _(e.x,e.y,1)}))}return e.prototype.pushPoint=function(e){this.points.push(_(e.x,e.y,1))},e.prototype.popPoint=function(){this.points.splice(this.points.length-1,1)},e.prototype.count=function(){return this.points.length},e.prototype.setPoints=function(e){void 0===e&&(e=[]),this.points=e.map((function(e){return _(e.x,e.y,1)}))},e.prototype.getPoints=function(){return this.points.map((function(e){return i(e.x,e.y)}))},e.prototype.reverse=function(){this.points.reverse()},e.prototype.append=function(e){var t;(t=this.points).push.apply(t,e.points)},e.prototype.shiftLeft=function(){var e;(e=this.points).push.apply(e,this.points.splice(0,1))},e.prototype.shiftRight=function(){this.points.splice(0,0,this.points.splice(this.points.length-1,1)[0])},e.prototype.close=function(){var e=this.points[0],t=this.points[this.points.length-1];e.x===t.x&&e.y===t.y||this.pushPoint(e)},e.prototype.transform=function(e){this.points=this.points.map((function(t){return J(e,t)}))},e.makeQuad=function(t,r,n,o){return new e([i(t,r),i(t,o),i(n,o),i(n,r),i(t,r)])},e.prototype.scale=function(e,t){for(var r=0,n=this.points;r<n.length;r++){var i=n[r];i.x*=e,i.y*=t}},e.prototype.toCssPath=function(e){return void 0===e&&(e="px"),"polygon("+this.points.map((function(t){return""+t.x+e+" "+t.y+e})).join(", ")+")"},e.prototype.getBoundingBox=function(){var e=this.points.map((function(e){return e.x})),t=this.points.map((function(e){return e.y})),r=Math.min.apply(Math,e),n=Math.min.apply(Math,t);return{x:r,y:n,width:Math.max.apply(Math,e)-r,height:Math.max.apply(Math,t)-n}},e}()}]);